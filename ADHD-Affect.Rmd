---
title: "ADHD Affect Cyclicity Paper"
author: "Jordan Barone, Tory Eisenlohr-Moul, Ashley Eng"
date: "Last compiled on `r format(Sys.time(), '%B %d, %Y')`"
output: html_document
---

### Package Import
```{r package import, include=FALSE}
library(usethis) #github setup
library(haven) #for reading files
library(ggplot2) #for plotting
library(tidyverse) #for data management and manipulation
library(dplyr)
library(zoo) #rolling averages
library(readxl) #reading in excel files
library(nlme)
library(lme4) #mlm
library(lmerTest) #mlm to pull p values
library(emmeans) #plot interaction using model-implied estimated marginal means
library(psych) #for describe function
library(performance) #get ICCs
library(rmcorr) # Calculate repeated measures correlations
library(gitcreds)
library(see) #required for model checking functions in performance
library(corrplot) #visualize correlations
library(lubridate)
library(visdat)
library(skimr)
library(psych)
library(GPArotation)
library(broom.mixed)
library(sjPlot)
library(lme4)
library(psych)
library(haven)


```

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)


# Turn off Scientific Notation Throughout
options(scipen = 999)


#Import Data

AdultADHDDailyData <- read_sav("~/Library/CloudStorage/Box-Box/ENG-CLEARLAB ADHD COLLAB/03_analytic_projects/Jordan codes/02_code_dataedits_output/Affect Paper data set and code/ADHD-affect/2023.02.03. DailySummary with earlylut coding.sav")
#View(AdultADHDDailyData)

#Remove participants with invalid cycles

badhormones <- c(206, 214, 221, 228)

#save new dataframe without all excluded participants
AdultADHDDailyData <- AdultADHDDailyData %>% 
  filter(!ID %in% badhormones) 


# NON_OV=1, else=0

AdultADHDDailyData <- AdultADHDDailyData %>%
  mutate(NON_OV = case_when(cyclephase_LH=="1" ~ "0", #OV
                                    cyclephase_LH=="2" ~ "1", #EL
                                    cyclephase_LH=="3" ~ "1", #ML
                                    cyclephase_LH=="4" ~ "1", #PERIM
                                    cyclephase_LH=="5" ~ "1")) #MIDFOL

# NON_PERI=1, else=0

AdultADHDDailyData <- AdultADHDDailyData %>%
  mutate(NON_PERI = case_when(cyclephase_LH=="1" ~ "1", #OV
                                    cyclephase_LH=="2" ~ "1", #EL
                                    cyclephase_LH=="3" ~ "1", #ML
                                    cyclephase_LH=="4" ~ "0", #PERIM
                                    cyclephase_LH=="5" ~ "1")) #MIDFOL

# NON_ML, else=0

AdultADHDDailyData <- AdultADHDDailyData %>%
  mutate(NON_ML = case_when(cyclephase_LH=="1" ~ "1", #OV
                                    cyclephase_LH=="2" ~ "1", #EL
                                    cyclephase_LH=="3" ~ "0", #ML
                                    cyclephase_LH=="4" ~ "1", #PERIM
                                    cyclephase_LH=="5" ~ "1")) #MIDFOL

# NON_EL, else=0

AdultADHDDailyData <- AdultADHDDailyData %>%
  mutate(NON_EL = case_when(cyclephase_LH=="1" ~ "1", #OV
                                    cyclephase_LH=="2" ~ "0", #EL
                                    cyclephase_LH=="3" ~ "1", #ML
                                    cyclephase_LH=="4" ~ "1", #PERIM
                                    cyclephase_LH=="5" ~ "1")) #MIDFOL


# ML_PERI_MF=1, else=0

AdultADHDDailyData <- AdultADHDDailyData %>%
  mutate(ML_PERI_MF = case_when(cyclephase_LH=="1" ~ "0", #OV
                                    cyclephase_LH=="2" ~ "0", #EL
                                    cyclephase_LH=="3" ~ "1", #ML
                                    cyclephase_LH=="4" ~ "1", #PERIM
                                    cyclephase_LH=="5" ~ "1")) #MIDFOL

# MF_OV_EL=1, else=0

AdultADHDDailyData <- AdultADHDDailyData %>%
  mutate(MF_OV_EL = case_when(cyclephase_LH=="1" ~ "1", #OV
                                    cyclephase_LH=="2" ~ "1", #EL
                                    cyclephase_LH=="3" ~ "0", #ML
                                    cyclephase_LH=="4" ~ "0", #PERIM
                                    cyclephase_LH=="5" ~ "1")) #MIDFOL

# PERI_OV_EL=1, else=0

AdultADHDDailyData <- AdultADHDDailyData %>%
  mutate(PERI_OV_EL = case_when(cyclephase_LH=="1" ~ "1", #OV
                                    cyclephase_LH=="2" ~ "1", #EL
                                    cyclephase_LH=="3" ~ "0", #ML
                                    cyclephase_LH=="4" ~ "1", #PERIM
                                    cyclephase_LH=="5" ~ "0")) #MIDFOL


# MF_EL_ML=1, else=0

AdultADHDDailyData <- AdultADHDDailyData %>%
  mutate(MF_EL_ML = case_when(cyclephase_LH=="1" ~ "0", #OV
                                    cyclephase_LH=="2" ~ "1", #EL
                                    cyclephase_LH=="3" ~ "1", #ML
                                    cyclephase_LH=="4" ~ "0", #PERIM
                                    cyclephase_LH=="5" ~ "1")) #MIDFOL

# EL_ML_PERI=1, else=0

AdultADHDDailyData <- AdultADHDDailyData %>%
  mutate(EL_ML_PERI = case_when(cyclephase_LH=="1" ~ "0", #OV
                                    cyclephase_LH=="2" ~ "1", #EL
                                    cyclephase_LH=="3" ~ "1", #ML
                                    cyclephase_LH=="4" ~ "1", #PERIM
                                    cyclephase_LH=="5" ~ "0")) #MIDFOL

# MF_EL_PERI=1, else=0

AdultADHDDailyData <- AdultADHDDailyData %>%
  mutate(MF_EL_PERI = case_when(cyclephase_LH=="1" ~ "0", #OV
                                    cyclephase_LH=="2" ~ "1", #EL
                                    cyclephase_LH=="3" ~ "0", #ML
                                    cyclephase_LH=="4" ~ "1", #PERIM
                                    cyclephase_LH=="5" ~ "1")) #MIDFOL


# MF_PERI_OV=1, else=0

AdultADHDDailyData <- AdultADHDDailyData %>%
  mutate(MF_PERI_OV = case_when(cyclephase_LH=="1" ~ "1", #OV
                                    cyclephase_LH=="2" ~ "0", #EL
                                    cyclephase_LH=="3" ~ "0", #ML
                                    cyclephase_LH=="4" ~ "1", #PERIM
                                    cyclephase_LH=="5" ~ "1")) #MIDFOL



# ML_PERI=1, else=0

AdultADHDDailyData <- AdultADHDDailyData %>%
  mutate(ML_PERI = case_when(cyclephase_LH=="1" ~ "0", #OV
                                    cyclephase_LH=="2" ~ "0", #EL
                                    cyclephase_LH=="3" ~ "1", #ML
                                    cyclephase_LH=="4" ~ "1", #PERIM
                                    cyclephase_LH=="5" ~ "0")) #MIDFOL

# PERI_MF=1, else=0

AdultADHDDailyData <- AdultADHDDailyData %>%
  mutate(PERI_MF = case_when(cyclephase_LH=="1" ~ "0", #OV
                                    cyclephase_LH=="2" ~ "0", #EL
                                    cyclephase_LH=="3" ~ "0", #ML
                                    cyclephase_LH=="4" ~ "1", #PERIM
                                    cyclephase_LH=="5" ~ "1")) #MIDFOL

# PERI_EL=1, else=0

AdultADHDDailyData <- AdultADHDDailyData %>%
  mutate(PERI_EL = case_when(cyclephase_LH=="1" ~ "0", #OV
                                    cyclephase_LH=="2" ~ "1", #EL
                                    cyclephase_LH=="3" ~ "0", #ML
                                    cyclephase_LH=="4" ~ "1", #PERIM
                                    cyclephase_LH=="5" ~ "0")) #MIDFOL

# MF_OV=1, else=0

AdultADHDDailyData <- AdultADHDDailyData %>%
  mutate(MF_OV = case_when(cyclephase_LH=="1" ~ "1", #OV
                                    cyclephase_LH=="2" ~ "0", #EL
                                    cyclephase_LH=="3" ~ "0", #ML
                                    cyclephase_LH=="4" ~ "0", #PERIM
                                    cyclephase_LH=="5" ~ "1")) #MIDFOL

# OV_EL=1, else=0

AdultADHDDailyData <- AdultADHDDailyData %>%
  mutate(OV_EL = case_when(cyclephase_LH=="1" ~ "1", #OV
                                    cyclephase_LH=="2" ~ "1", #EL
                                    cyclephase_LH=="3" ~ "0", #ML
                                    cyclephase_LH=="4" ~ "0", #PERIM
                                    cyclephase_LH=="5" ~ "0")) #MIDFOL

# EL_ML=1, else=0

AdultADHDDailyData <- AdultADHDDailyData %>%
  mutate(EL_ML = case_when(cyclephase_LH=="1" ~ "0", #OV
                                    cyclephase_LH=="2" ~ "1", #EL
                                    cyclephase_LH=="3" ~ "1", #ML
                                    cyclephase_LH=="4" ~ "0", #PERIM
                                    cyclephase_LH=="5" ~ "0")) #MIDFOL

# EL=1, else=0

AdultADHDDailyData <- AdultADHDDailyData %>%
  mutate(EL = case_when(cyclephase_LH=="1" ~ "0", #OV
                                    cyclephase_LH=="2" ~ "1", #EL
                                    cyclephase_LH=="3" ~ "0", #ML
                                    cyclephase_LH=="4" ~ "0", #PERI
                                    cyclephase_LH=="5" ~ "0")) #MIDFOL

# PO=1, else=0

AdultADHDDailyData <- AdultADHDDailyData %>%
  mutate(PO = case_when(cyclephase_LH=="1" ~ "1", #OV
                                    cyclephase_LH=="2" ~ "0", #EL
                                    cyclephase_LH=="3" ~ "0", #ML
                                    cyclephase_LH=="4" ~ "0", #PERI
                                    cyclephase_LH=="5" ~ "0")) #MIDFOL

# PERI=1, else=0

AdultADHDDailyData <- AdultADHDDailyData %>%
  mutate(PERI = case_when(cyclephase_LH=="1" ~ "0", #OV
                                    cyclephase_LH=="2" ~ "0", #EL
                                    cyclephase_LH=="3" ~ "0", #ML
                                    cyclephase_LH=="4" ~ "1", #PERI
                                    cyclephase_LH=="5" ~ "0")) #MIDFOL

# ML=1, else=0

AdultADHDDailyData <- AdultADHDDailyData %>%
  mutate(ML = case_when(cyclephase_LH=="1" ~ "0", #OV
                                    cyclephase_LH=="2" ~ "0", #EL
                                    cyclephase_LH=="3" ~ "1", #ML
                                    cyclephase_LH=="4" ~ "0", #PERI
                                    cyclephase_LH=="5" ~ "0")) #MIDFOL

# MF=1, else=0

AdultADHDDailyData <- AdultADHDDailyData %>%
  mutate(MF = case_when(cyclephase_LH=="1" ~ "0", #OV
                                    cyclephase_LH=="2" ~ "0", #EL
                                    cyclephase_LH=="3" ~ "0", #ML
                                    cyclephase_LH=="4" ~ "0", #PERI
                                    cyclephase_LH=="5" ~ "1")) #MF

#View(AdultADHDDailyData)

```



#Step 1: Prepare functions
```{r}

#function to create person means
create.person.mean <- function(df, var, ...) {
  df %>%
    group_by(...) %>%
    mutate("{{var}}.m" := mean({{var}}, na.rm=T))
}
#function to create person deviations (note, must have person means already made)
create.deviation <- function(df, var, var.m) {
  df <- df %>%
    rowwise() %>%
    mutate("{{var}}.d" := {{var}} - {{var.m}})
}

```
#Step 2: Prepare person-centered means and deviations
```{r}
#create list of outcomes
ADHD_varlist <- c("BDEFS_WM_avg",
           "BDEFS_RI_avg",
           "IA_Count",
           "Imp_Count",
           "Hyp_Count",
           "DEBQ_avg",
           "UPPS_NU_avg",
           "UPPS_Persev_avg",
           "UPPS_Premed_avg",
           "UPPS_Sens_avg",
           "UPPS_PU_avg",
           "Estradiol",
           "Progesterone",
           "LH",
           "DRSP_1",
           "DRSP_2",
           "DRSP_3",
           "DRSP_4",
           "DRSP_5",
           "DRSP_6",
           "DRSP_7",
           "DRSP_8",
           "DRSP_9",
           "DRSP_10",
           "DRSP_11",
           "DRSP_12",
           "DRSP_13",
           "DRSP_14",
           "DRSP_15",
           "DRSP_16",
           "DRSP_17",
           "DRSP_22",
           "DRSP_23") %>% noquote()



#execute for loop: run create.person.mean() on everything in "outcomelist"
for (i in ADHD_varlist) {
  AdultADHDDailyData <- create.person.mean(AdultADHDDailyData, !!sym({{i}}), ID)
}
#execute for loop: run create.deviation() on everything in list
for (i in ADHD_varlist) {
  AdultADHDDailyData <- create.deviation(AdultADHDDailyData, !!sym({{i}}), !!sym(paste0({{i}}, ".m")))
}



View (AdultADHDDailyData)
```
#Step 3: Plot daily data by phase
```{r}
#Plot Daily Data by Phase
#set up labels
AdultADHDDailyData$cyclephase_names <- factor(AdultADHDDailyData$cyclephase_LH, levels = c(1,2,3,4,5), labels = c("PO", "EL", "ML", "PM", "MF"))

#person-mean-center
data_for_plot1a <- AdultADHDDailyData %>% group_by(ID, cyclephase_names) %>% 
  summarize(Hyp_Count.m=mean(Hyp_Count.m),
            Hypphase.m = mean(Hyp_Count, na.rm = TRUE),
            Hypphase.d = Hypphase.m - Hyp_Count.m)%>%
filter(!is.na(cyclephase_names))

plot1a <- data_for_plot1a %>% 
  group_by(cyclephase_names) %>%
  summarize(grand.m.Hyp_Count.d = mean(Hypphase.d, na.rm=T),
            se=sd(Hypphase.d, na.rm=T)/sqrt(n())) %>%
  #can save the above code into a separate dataset if preferred (dont have to do it in one line w/ ggplot)
  ggplot(aes(x=cyclephase_names, y=grand.m.Hyp_Count.d))+
  geom_line(group=1)+
  ##everything from here down is just formatting
  scale_x_discrete(labels=c("PO" = "Periovulatory",
                            "EL" = "Earlyluteal",
                            "ML" = "Midluteal",
                            "PM" = "Perimenstrual",
                            "MF" = "Midfollicular" ))+
  geom_errorbar(aes(ymin=grand.m.Hyp_Count.d-se, 
                    ymax=grand.m.Hyp_Count.d+se), 
                size=0.5, width=0.5, position=position_dodge())+
  geom_hline(yintercept=0.0, color="red", linetype="dashed")+
  theme_bw()+
  xlab("Cycle Phase")+
  ylab("Person-Centered Hyperactivity")
#run plot1a in console to see plot
plot1a

```
#Step 4: Graph daily data by day
```{r}
#Graphing Outcome Variables (Day 0 is Ovulation)
AdultADHDDailyData %>% group_by(daycountLH) %>%
  summarize(personcentered.dev = mean(BDEFS_WM_avg.d, na.rm=T),
            se=sd(BDEFS_WM_avg.d, na.rm=T)/sqrt(n())) %>%
  arrange(daycountLH) %>%
  mutate(roll= rollapply(personcentered.dev, 3, 
                         mean, align = "center", fill=NA)) %>%
  ggplot(aes(x=daycountLH, y=roll))+
  geom_line(group=1)

#Graphing Hyperactivity Symptom Count (out of 6)
AdultADHDDailyData %>% group_by(daycountLH) %>%
  summarize(personcentered.dev = mean(Hyp_Count.d, na.rm=T),
            se=sd(Hyp_Count.d, na.rm=T)/sqrt(n())) %>%
  arrange(daycountLH) %>%
  mutate(roll= rollapply(personcentered.dev, 3, 
                         mean, align = "center", fill=NA)) %>%
  ggplot(aes(x=daycountLH, y=roll))+
  geom_line(group=1)+
geom_hline(yintercept = 0, linetype="dashed", col="red")+
  geom_errorbar(aes(ymin=roll-se, ymax=roll+se), 
                size=0.5, width=0.5, position=position_dodge())+
  scale_y_continuous(expand = c(0,0.005))+
  theme_bw()+
  xlab("Cycle Day (based on LH-surge and menses self-report)")+
  ylab("Person-Centered Hyperactivity")

#Graphing Inattention Symptom Count (out of 9)
AdultADHDDailyData %>% group_by(daycountLH) %>%
  summarize(personcentered.dev = mean(IA_Count.d, na.rm=T),
            se=sd(IA_Count.d, na.rm=T)/sqrt(n())) %>%
  arrange(daycountLH) %>%
  mutate(roll= rollapply(personcentered.dev, 3, 
                         mean, align = "center", fill=NA)) %>%
  ggplot(aes(x=daycountLH, y=roll))+
  geom_line(group=1)+
geom_hline(yintercept = 0, linetype="dashed", col="red")+
  geom_errorbar(aes(ymin=roll-se, ymax=roll+se), 
                size=0.5, width=0.5, position=position_dodge())+
  scale_y_continuous(expand = c(0,0.005))+
  theme_bw()+
  xlab("Cycle Day (based on LH-surge and menses self-report)")+
  ylab("Person-Centered Inattention")

#Graphing Impulsivity Symptom Count (out of 3)
AdultADHDDailyData %>% group_by(daycountLH) %>%
  summarize(personcentered.dev = mean(Imp_Count.d, na.rm=T),
            se=sd(Imp_Count.d, na.rm=T)/sqrt(n())) %>%
  arrange(daycountLH) %>%
  mutate(roll= rollapply(personcentered.dev, 3, 
                         mean, align = "center", fill=NA)) %>%
  ggplot(aes(x=daycountLH, y=roll))+
  geom_line(group=1)+
geom_hline(yintercept = 0, linetype="dashed", col="red")+
  geom_errorbar(aes(ymin=roll-se, ymax=roll+se), 
                size=0.5, width=0.5, position=position_dodge())+
  scale_y_continuous(expand = c(0,0.005))+
  theme_bw()+
  xlab("Cycle Day (based on LH-surge and menses self-report)")+
  ylab("Person-Centered Impulsivity")

#Graphing BDEFS_RI (out of 4)
AdultADHDDailyData %>% group_by(daycountLH) %>%
  summarize(personcentered.dev = mean(BDEFS_RI_avg.d, na.rm=T),
            se=sd(BDEFS_RI_avg.d, na.rm=T)/sqrt(n())) %>%
  arrange(daycountLH) %>%
  mutate(roll= rollapply(personcentered.dev, 3, 
                         mean, align = "center", fill=NA)) %>%
  ggplot(aes(x=daycountLH, y=roll))+
  geom_line(group=1)+
geom_hline(yintercept = 0, linetype="dashed", col="red")+
  geom_errorbar(aes(ymin=roll-se, ymax=roll+se), 
                size=0.5, width=0.5, position=position_dodge())+
  scale_y_continuous(expand = c(0,0.005))+
  theme_bw()+
  xlab("Cycle Day (based on LH-surge and menses self-report)")+
  ylab("Person-Centered Response Inhibition")

#Graphing BDEFS_WM (out of 4)
AdultADHDDailyData %>% group_by(daycountLH) %>%
  summarize(personcentered.dev = mean(BDEFS_WM_avg.d, na.rm=T),
            se=sd(BDEFS_WM_avg.d, na.rm=T)/sqrt(n())) %>%
  arrange(daycountLH) %>%
  mutate(roll= rollapply(personcentered.dev, 3, 
                         mean, align = "center", fill=NA)) %>%
  ggplot(aes(x=daycountLH, y=roll))+
  geom_line(group=1)+
geom_hline(yintercept = 0, linetype="dashed", col="red")+
  geom_errorbar(aes(ymin=roll-se, ymax=roll+se), 
                size=0.5, width=0.5, position=position_dodge())+
  scale_y_continuous(expand = c(0,0.005))+
  theme_bw()+
  xlab("Cycle Day (based on LH-surge and menses self-report)")+
  ylab("Person-Centered Working Memory")

#Graphing DRSP Depression
AdultADHDDailyData %>% group_by(daycountLH) %>%
  summarize(personcentered.dev = mean(DRSP_1.d, na.rm=T),
            se=sd(DRSP_1.d, na.rm=T)/sqrt(n())) %>%
  arrange(daycountLH) %>%
  mutate(roll= rollapply(personcentered.dev, 3, 
                         mean, align = "center", fill=NA)) %>%
  ggplot(aes(x=daycountLH, y=roll))+
  geom_line(group=1)+
geom_hline(yintercept = 0, linetype="dashed", col="red")+
  geom_errorbar(aes(ymin=roll-se, ymax=roll+se), 
                size=0.5, width=0.5, position=position_dodge())+
  scale_y_continuous(expand = c(0,0.005))+
  theme_bw()+
  xlab("Cycle Day (based on LH-surge and menses self-report)")+
  ylab("Person-Centered Depression")

#Graphing DRSP Hopeless
AdultADHDDailyData %>% group_by(daycountLH) %>%
  summarize(personcentered.dev = mean(DRSP_2.d, na.rm=T),
            se=sd(DRSP_2.d, na.rm=T)/sqrt(n())) %>%
  arrange(daycountLH) %>%
  mutate(roll= rollapply(personcentered.dev, 3, 
                         mean, align = "center", fill=NA)) %>%
  ggplot(aes(x=daycountLH, y=roll))+
  geom_line(group=1)+
geom_hline(yintercept = 0, linetype="dashed", col="red")+
  geom_errorbar(aes(ymin=roll-se, ymax=roll+se), 
                size=0.5, width=0.5, position=position_dodge())+
  scale_y_continuous(expand = c(0,0.005))+
  theme_bw()+
  xlab("Cycle Day (based on LH-surge and menses self-report)")+
  ylab("Person-Centered Hopeless")

#Anxiety, Anger, Overwhelm
#Graphing DRSP Anxiety
AdultADHDDailyData %>% group_by(daycountLH) %>%
  summarize(personcentered.dev = mean(DRSP_4.d, na.rm=T),
            se=sd(DRSP_4.d, na.rm=T)/sqrt(n())) %>%
  arrange(daycountLH) %>%
  mutate(roll= rollapply(personcentered.dev, 3, 
                         mean, align = "center", fill=NA)) %>%
  ggplot(aes(x=daycountLH, y=roll))+
  geom_line(group=1)+
geom_hline(yintercept = 0, linetype="dashed", col="red")+
  geom_errorbar(aes(ymin=roll-se, ymax=roll+se), 
                size=0.5, width=0.5, position=position_dodge())+
  scale_y_continuous(expand = c(0,0.005))+
  theme_bw()+
  xlab("Cycle Day (based on LH-surge and menses self-report)")+
  ylab("Person-Centered Anxiety")

#Graphing DRSP Anger
AdultADHDDailyData %>% group_by(daycountLH) %>%
  summarize(personcentered.dev = mean(DRSP_7.d, na.rm=T),
            se=sd(DRSP_7.d, na.rm=T)/sqrt(n())) %>%
  arrange(daycountLH) %>%
  mutate(roll= rollapply(personcentered.dev, 3, 
                         mean, align = "center", fill=NA)) %>%
  ggplot(aes(x=daycountLH, y=roll))+
  geom_line(group=1)+
geom_hline(yintercept = 0, linetype="dashed", col="red")+
  geom_errorbar(aes(ymin=roll-se, ymax=roll+se), 
                size=0.5, width=0.5, position=position_dodge())+
  scale_y_continuous(expand = c(0,0.005))+
  theme_bw()+
  xlab("Cycle Day (based on LH-surge and menses self-report)")+
  ylab("Person-Centered Anger/Irritability")

#Graphing DRSP Overwhelmed/Can't Cope
AdultADHDDailyData %>% group_by(daycountLH) %>%
  summarize(personcentered.dev = mean(DRSP_16.d, na.rm=T),
            se=sd(DRSP_16.d, na.rm=T)/sqrt(n())) %>%
  arrange(daycountLH) %>%
  mutate(roll= rollapply(personcentered.dev, 3, 
                         mean, align = "center", fill=NA)) %>%
  ggplot(aes(x=daycountLH, y=roll))+
  geom_line(group=1)+
geom_hline(yintercept = 0, linetype="dashed", col="red")+
  geom_errorbar(aes(ymin=roll-se, ymax=roll+se), 
                size=0.5, width=0.5, position=position_dodge())+
  scale_y_continuous(expand = c(0,0.005))+
  theme_bw()+
  xlab("Cycle Day (based on LH-surge and menses self-report)")+
  ylab("Person-Centered Overwhelmed/Can't Cope")

#Graphing DEBQ_avg
AdultADHDDailyData %>% group_by(daycountLH) %>%
  summarize(personcentered.dev = mean(DEBQ_avg.d, na.rm=T),
            se=sd(DEBQ_avg.d, na.rm=T)/sqrt(n())) %>%
  arrange(daycountLH) %>%
  mutate(roll= rollapply(personcentered.dev, 3, 
                         mean, align = "center", fill=NA)) %>%
  ggplot(aes(x=daycountLH, y=roll))+
  geom_line(group=1)+
geom_hline(yintercept = 0, linetype="dashed", col="red")+
  geom_errorbar(aes(ymin=roll-se, ymax=roll+se), 
                size=0.5, width=0.5, position=position_dodge())+
  scale_y_continuous(expand = c(0,0.005))+
  theme_bw()+
  xlab("Cycle Day (based on LH-surge and menses self-report)")+
  ylab("Person-Centered Emotional Eating")

#Other left over code
  mutate(roll= rollapply(personcentered.dev, 3, 
                         mean, align = "center", fill=NA)) %>%
  ggplot(aes(x=daycountLH, y=roll,
             group=predictor, color=predictor))+
  geom_line()+
  geom_hline(yintercept = 0, linetype="dashed", col="gray")+
  #geom_errorbar(aes(ymin=roll-se, ymax=roll+se), 
   #             size=0.5, width=0.5, position=position_dodge())+
  scale_y_continuous(expand = c(0,0.005))+
  theme_bw()+
  xlab("Cycle Day (based on LH-surge and menses self-report)")+
  ylab("Person-Centered Affective Variables")+
  annotate("text", x="0L", y=-0.32, label="*", size=8, color="blue")+
  annotate("text", x="1M", y=-0.32, label="*", size=8, color="blue")+
  labs(color = "")+
  theme(legend.position = "bottom")
```

#Step 4: Model Data


## Tory Affect Models at OSSD
## Model Fitting for Manuscript - Depression
```{r}

# PERIMENS REF
model1a <- lmer(DRSP_1 ~ midluteal_LH +earlylut_LH+periov_LH + midfol_LH + 
              (1 + midluteal_LH +earlylut_LH+periov_LH + midfol_LH  | ID), data = AdultADHDDailyData)

summary(model1a)
ranova(model1a)
check_outliers(model1a)
check_heteroscedasticity(model1a)
check_normality(model1a)

#Check Residual Distribution

residuals <- resid(model1a)
hist(residuals)


# Extract the random slopes for each level of the categorical variable
random_slopes <- ranef(model1a)$studyperiod

# Remove Intercept

random_slopes <- random_slopes[, -1]

# Apply factor analysis to the correlation matrix
fa <- fa(r = random_slopes, nfactors = 2, rotate = "oblimin", fm="minres")

# Print results
fa

scree(random_slopes)


# PERIMENS REF
model1ar <- lmer(DRSP_1 ~ midluteal_LH +earlylut_LH+periov_LH + midfol_LH + 
              (1 + NON_PERI  | ID), data = AdultADHDDailyData)

summary(model1ar)
ranova(model1ar)

tab_model(model1ar)


# MIDLUTEAL REF
model1b <- lmer(DRSP_1 ~ perimenstrual_LH + earlylut_LH+periov_LH+midfol_LH +
              (1 + perimenstrual_LH + earlylut_LH+periov_LH+midfol_LH | ID), data = AdultADHDDailyData)

summary(model1b)

ranova(model1b)
check_outliers(model1b)
check_heteroscedasticity(model1b)
check_normality(model1b)

#Check Residual Distribution

residuals <- resid(model1b)
hist(residuals)


# Extract the random slopes for each level of the categorical variable
random_slopes <- ranef(model1b)$ID

# Remove Intercept

random_slopes <- random_slopes[, -1]

# Apply factor analysis to the correlation matrix
fa <- fa(r = random_slopes, nfactors = 2, rotate = "oblimin", fm="minres")

# Print results
fa

scree(random_slopes)

tab_model(model1b)


# EARLY LUT REF
model1c <- lmer(DRSP_1 ~periov_LH+ midfol_LH+perimenstrual_LH + midluteal_LH+
              (1 + periov_LH+ midfol_LH+perimenstrual_LH + midluteal_LH | ID), data = AdultADHDDailyData)

summary(model1c)

ranova(model1c)
check_outliers(model1c)
check_heteroscedasticity(model1c)
check_normality(model1c)

#Check Residual Distribution

residuals <- resid(model1c)
hist(residuals)


# Extract the random slopes for each level of the categorical variable
random_slopes <- ranef(model1c)$ID

# Remove Intercept

random_slopes <- random_slopes[, -1]

# Apply factor analysis to the correlation matrix
fa <- fa(r = random_slopes, nfactors = 2, rotate = "oblimin", fm="minres")

# Print results
fa

scree(random_slopes)

model1cr <- lmer(DRSP_1 ~periov_LH+ midfol_LH+perimenstrual_LH + midluteal_LH+
              (1 + NON_EL | ID), data = AdultADHDDailyData)

summary(model1cr)

ranova(model1cr)

# PERIOV REF
model1d <- lmer(DRSP_1 ~midfol_LH+perimenstrual_LH + midluteal_LH+ earlylut_LH+
              (1 + midfol_LH+perimenstrual_LH + midluteal_LH+ earlylut_LH | ID), data = AdultADHDDailyData)

summary(model1d)

ranova(model1d)
check_outliers(model1d)
check_heteroscedasticity(model1d)
check_normality(model1d)

#Check Residual Distribution

residuals <- resid(model1d)
hist(residuals)


# Extract the random slopes for each level of the categorical variable
random_slopes <- ranef(model1d)$ID

# Remove Intercept

random_slopes <- random_slopes[, -1]

# Apply factor analysis to the correlation matrix
fa <- fa(r = random_slopes, nfactors = 2, rotate = "oblimin", fm="minres")

# Print results
fa

scree(random_slopes)

# PERIOV REF - combine
model1dr <- lmer(DRSP_1 ~midfol_LH+perimenstrual_LH + midluteal_LH+ earlylut_LH+
              (1 + NON_OV | ID), data = AdultADHDDailyData)

summary(model1dr)

ranova(model1dr)

tab_model(model1dr)


# FINAL DEPRESSION MODELS: 

tab_model(model1ar, model1b, model1cr, model1dr)



```


## Model Fitting for Manuscript - Hopelessness
```{r}

# PERIMENS REF
model1a <- lmer(DRSP_2 ~ midluteal_LH +earlylut_LH+periov_LH + midfol_LH + 
              (1 + midluteal_LH +earlylut_LH+periov_LH + midfol_LH  | ID), data = AdultADHDDailyData)

summary(model1a)
ranova(model1a)
check_outliers(model1a)
check_heteroscedasticity(model1a)
check_normality(model1a)

#Check Residual Distribution

residuals <- resid(model1a)
hist(residuals)

# Extract the random slopes for each level of the categorical variable
random_slopes <- ranef(model1a)$ID

# Remove Intercept

random_slopes <- random_slopes[, -1]

# Apply factor analysis to the correlation matrix
fa <- fa(r = random_slopes, nfactors = 2, rotate = "oblimin", fm="minchi")

# Print results
fa

scree(random_slopes)

tab_model(model1a)

# PERIMENS REF
model1ar <- lmer(DRSP_2 ~ midluteal_LH +earlylut_LH+periov_LH + midfol_LH + 
              (1 + MF_OV_EL + ML  | ID), data = AdultADHDDailyData)

summary(model1ar)
ranova(model1ar)
tab_model(model1ar)

# MIDLUTEAL REF - peri separate
model1b <- lmer(DRSP_2 ~ perimenstrual_LH + earlylut_LH+periov_LH+midfol_LH +
              (1 + perimenstrual_LH + earlylut_LH+ periov_LH+ midfol_LH| ID), data = AdultADHDDailyData)

summary(model1b)

ranova(model1b)

check_outliers(model1b)
check_heteroscedasticity(model1b)
check_normality(model1b)

#Check Residual Distribution

residuals <- resid(model1b)
hist(residuals)

# Extract the random slopes for each level of the categorical variable
random_slopes <- ranef(model1b)$ID

# Remove Intercept

random_slopes <- random_slopes[, -1]

# Apply factor analysis to the correlation matrix
fa <- fa(r = random_slopes, nfactors = 2, rotate = "oblimin", fm="minchi")

# Print results
fa

scree(random_slopes)

# peri separate
model1br <- lmer(DRSP_2 ~ perimenstrual_LH + earlylut_LH+periov_LH+midfol_LH +
              (1 + MF_OV_EL+PERI| ID), data = AdultADHDDailyData)

summary(model1br)
tab_model(model1br)

ranova(model1b)

check_outliers(model1b)
check_heteroscedasticity(model1b)
check_normality(model1b)


# EARLY LUT REF
model1c <- lmer(DRSP_2 ~ periov_LH+ midfol_LH+perimenstrual_LH + midluteal_LH+
              (1 + periov_LH+ midfol_LH+perimenstrual_LH + midluteal_LH | ID), data = AdultADHDDailyData)

summary(model1c)

ranova(model1c)
check_outliers(model1c)
check_heteroscedasticity(model1c)
check_normality(model1c)

#Check Residual Distribution

residuals <- resid(model1c)
hist(residuals)


# Extract the random slopes for each level of the categorical variable
random_slopes <- ranef(model1c)$ID

# Remove Intercept

random_slopes <- random_slopes[, -1]

# Apply factor analysis to the correlation matrix
fa <- fa(r = random_slopes, nfactors = 3, rotate = "oblimin")

# Print results
fa

scree(random_slopes)

tab_model(model1c)

# EARLY LUT REF - RANDOM EFFECTS CHANGES
model1cr <- lmer(DRSP_2 ~ periov_LH+ midfol_LH+perimenstrual_LH + midluteal_LH+
              (1 + PERI_MF_OV +midluteal_LH | ID), data = AdultADHDDailyData)

summary(model1cr)
ranova(model1cr)
tab_model(model1cr)


# PERIOV REF
model1d <- lmer(DRSP_2 ~midfol_LH+perimenstrual_LH + midluteal_LH+ earlylut_LH+
              (1 + NON_OV | ID), data = AdultADHDDailyData)

summary(model1d)

ranova(model1d)
tab_model(model1d)
check_outliers(model1d)
check_heteroscedasticity(model1d)
check_normality(model1d)

# FINAL MODELS: 

tab_model(model list here)


```

## Model Fitting for Manuscript - Worthlessness/Guilt
```{r}

# PERIMENS REF
model1a <- lmer(DRSP_3 ~ midluteal_LH +earlylut_LH+periov_LH + midfol_LH + 
              (1 + midluteal_LH +earlylut_LH+periov_LH + midfol_LH  | ID), data = AdultADHDDailyData)

summary(model1a)
ranova(model1a)
check_outliers(model1a)
check_heteroscedasticity(model1a)
check_normality(model1a)

#Check Residual Distribution

residuals <- resid(model1a)
hist(residuals)


# Extract the random slopes for each level of the categorical variable
random_slopes <- ranef(model1a)$ID

# Remove Intercept

random_slopes <- random_slopes[, -1]

# Apply factor analysis to the correlation matrix
fa <- fa(r = random_slopes, nfactors = 2, rotate = "oblimin", fm="minres")

# Print results
fa

scree(random_slopes)


tab_model(model1a)


# MIDLUTEAL REF - NEED TO TROUBLESHOOT
model1b <- lmer(DRSP_3 ~ perimenstrual_LH + earlylut_LH+periov_LH+midfol_LH +
              (1 + perimenstrual_LH + earlylut_LH+periov_LH+midfol_LH | ID), data = AdultADHDDailyData)

summary(model1b)

ranova(model1b)
check_outliers(model1b)
check_heteroscedasticity(model1b)
check_normality(model1b)

#Check Residual Distribution

residuals <- resid(model1b)
hist(residuals)


# Extract the random slopes for each level of the categorical variable
random_slopes <- ranef(model1b)$ID

# Remove Intercept

random_slopes <- random_slopes[, -1]

# Apply factor analysis to the correlation matrix
fa <- fa(r = random_slopes, nfactors = 2, rotate = "oblimin", fm="minchi")

# Print results
fa

scree(random_slopes)

tab_model(model1b)

# MIDLUTEAL REF - separate random slopes
model1br <- lmer(DRSP_3 ~ perimenstrual_LH + earlylut_LH+periov_LH+midfol_LH +
              (1 + perimenstrual_LH + OV_EL + midfol_LH | ID), data = AdultADHDDailyData)

summary(model1br)
ranova(model1br)
tab_model(model1br)

# EARLY LUT REF
model1c <- lmer(DRSP_3 ~periov_LH+ midfol_LH+perimenstrual_LH + midluteal_LH+
              (1 + periov_LH+ midfol_LH+perimenstrual_LH + midluteal_LH | ID), data = AdultADHDDailyData)

summary(model1c)

ranova(model1c)
check_outliers(model1c)
check_heteroscedasticity(model1c)
check_normality(model1c)

#Check Residual Distribution

residuals <- resid(model1c)
hist(residuals)


# Extract the random slopes for each level of the categorical variable
random_slopes <- ranef(model1c)$ID

# Remove Intercept

random_slopes <- random_slopes[, -1]

# Apply factor analysis to the correlation matrix
fa <- fa(r = random_slopes, nfactors = 2, rotate = "oblimin", fm="minchi")

# Print results
fa

scree(random_slopes)

tab_model(model1c)

# EARLY LUT REF - new random slopes
model1cr <- lmer(DRSP_3 ~periov_LH+ midfol_LH+perimenstrual_LH + midluteal_LH+
              (1 + ML_PERI_MF | ID), data = AdultADHDDailyData)

summary(model1cr)
ranova(model1cr)
tab_model(model1cr)


# PERIOV REF
model1d <- lmer(DRSP_3 ~midfol_LH+perimenstrual_LH + midluteal_LH+ earlylut_LH+
              (1 + midfol_LH+perimenstrual_LH + midluteal_LH+ earlylut_LH | ID), data = AdultADHDDailyData)

summary(model1d)
ranova(model1d)

tab_model(model1d)


```



## Model Fitting for Manuscript - Anxiety
```{r}

# PERIMENS REF
model1a <- lmer(DRSP_4 ~ midluteal_LH +earlylut_LH+periov_LH + midfol_LH + 
              (1 + midluteal_LH +earlylut_LH+periov_LH + midfol_LH  | ID), data = AdultADHDDailyData)

summary(model1a)
ranova(model1a)
check_outliers(model1a)
check_heteroscedasticity(model1a)
check_normality(model1a)

#Check Residual Distribution

residuals <- resid(model1a)
hist(residuals)


# Extract the random slopes for each level of the categorical variable
random_slopes <- ranef(model1a)$ID

# Remove Intercept

random_slopes <- random_slopes[, -1]

# Apply factor analysis to the correlation matrix
fa <- fa(r = random_slopes, nfactors = 3, rotate = "oblimin", fm="minres")

# Print results
fa

scree(random_slopes)


tab_model(model1a)

# PERIMENS REF 
model1ar <- lmer(DRSP_4 ~ midluteal_LH +earlylut_LH+periov_LH + midfol_LH + 
              (1 + EL_ML +MF_OV  | ID), data = AdultADHDDailyData)

summary(model1ar)
ranova(model1ar)
tab_model(model1ar)


# MIDLUTEAL REF - NEED TO TROUBLESHOOT
model1b <- lmer(DRSP_4 ~ perimenstrual_LH + earlylut_LH+periov_LH+midfol_LH +
              (1 + perimenstrual_LH + earlylut_LH+periov_LH+midfol_LH | ID), data = AdultADHDDailyData)

summary(model1b)

ranova(model1b)
check_outliers(model1b)
check_heteroscedasticity(model1b)
check_normality(model1b)

#Check Residual Distribution

residuals <- resid(model1b)
hist(residuals)


# Extract the random slopes for each level of the categorical variable
random_slopes <- ranef(model1b)$ID

# Remove Intercept

random_slopes <- random_slopes[, -1]

# Apply factor analysis to the correlation matrix
fa <- fa(r = random_slopes, nfactors = 2, rotate = "oblimin", fm="minchi")

# Print results
fa

scree(random_slopes)

tab_model(model1b)

# MIDLUTEAL REF - separate random slopes
model1br <- lmer(DRSP_4 ~ perimenstrual_LH + earlylut_LH+periov_LH+midfol_LH +
              (1 + MF_OV + ML_PERI | ID), data = AdultADHDDailyData)

summary(model1br)
ranova(model1br)
tab_model(model1br)

# EARLY LUT REF
model1c <- lmer(DRSP_4 ~periov_LH+ midfol_LH+perimenstrual_LH + midluteal_LH+
              (1 + periov_LH+ midfol_LH+perimenstrual_LH + midluteal_LH | ID), data = AdultADHDDailyData)

summary(model1c)

ranova(model1c)
check_outliers(model1c)
check_heteroscedasticity(model1c)
check_normality(model1c)

#Check Residual Distribution

residuals <- resid(model1c)
hist(residuals)


# Extract the random slopes for each level of the categorical variable
random_slopes <- ranef(model1c)$ID

# Remove Intercept

random_slopes <- random_slopes[, -1]

# Apply factor analysis to the correlation matrix
fa <- fa(r = random_slopes, nfactors = 2, rotate = "oblimin", fm="minchi")

# Print results
fa

scree(random_slopes)

tab_model(model1c)

# EARLY LUT REF - new random slopes
model1cr <- lmer(DRSP_4 ~periov_LH+ midfol_LH+perimenstrual_LH + midluteal_LH+
              (1 + MF_OV + ML_PERI | ID), data = AdultADHDDailyData)

summary(model1cr)
ranova(model1cr)
tab_model(model1cr)


# PERIOV REF
model1d <- lmer(DRSP_4 ~midfol_LH+perimenstrual_LH + midluteal_LH+ earlylut_LH+
              (1 + midfol_LH+perimenstrual_LH + midluteal_LH+ earlylut_LH | ID), data = AdultADHDDailyData)

summary(model1d)
ranova(model1d)

tab_model(model1d)

# Extract the random slopes for each level of the categorical variable
random_slopes <- ranef(model1d)$ID

# Remove Intercept

random_slopes <- random_slopes[, -1]

# Apply factor analysis to the correlation matrix
fa <- fa(r = random_slopes, nfactors = 2, rotate = "oblimin", fm="minchi")

# Print results
fa

scree(random_slopes)

# PERIOV REF - new random
model1dr <- lmer(DRSP_4 ~midfol_LH+perimenstrual_LH + midluteal_LH+ earlylut_LH+
              (1 + EL_ML_PERI +MF | ID), data = AdultADHDDailyData)

summary(model1dr)
ranova(model1dr)
tab_model(model1dr)


```








## Model Fitting for Manuscript - Mood Swings Models
```{r}

# PERIMENS REF
model1a <- lmer(DRSP_5 ~ midluteal_LH +earlylut_LH+periov_LH + midfol_LH + 
              (1 + midluteal_LH +earlylut_LH+periov_LH + midfol_LH  | ID), data = AdultADHDDailyData)

summary(model1a)
ranova(model1a)
check_outliers(model1a)
check_heteroscedasticity(model1a)
check_normality(model1a)

#Check Residual Distribution

residuals <- resid(model1a)
hist(residuals)


# Extract the random slopes for each level of the categorical variable
random_slopes <- ranef(model1a)$ID

# Remove Intercept

random_slopes <- random_slopes[, -1]

# Apply factor analysis to the correlation matrix
fa <- fa(r = random_slopes, nfactors = 2, rotate = "oblimin", fm="minres")

# Print results
fa

scree(random_slopes)


tab_model(model1a)

# PERIMENS REF 
model1ar <- lmer(DRSP_5 ~ midluteal_LH +earlylut_LH+periov_LH + midfol_LH + 
              (1 + EL_ML_PERI + MF  | ID), data = AdultADHDDailyData)

summary(model1ar)
ranova(model1ar)
tab_model(model1ar)


# MIDLUTEAL REF 
model1b <- lmer(DRSP_5 ~ perimenstrual_LH + earlylut_LH+periov_LH+midfol_LH +
              (1 + perimenstrual_LH + earlylut_LH+periov_LH+midfol_LH | ID), data = AdultADHDDailyData)

summary(model1b)

ranova(model1b)
check_outliers(model1b)
check_heteroscedasticity(model1b)
check_normality(model1b)

#Check Residual Distribution

residuals <- resid(model1b)
hist(residuals)


# Extract the random slopes for each level of the categorical variable
random_slopes <- ranef(model1b)$ID

# Remove Intercept

random_slopes <- random_slopes[, -1]

# Apply factor analysis to the correlation matrix
fa <- fa(r = random_slopes, nfactors = 2, rotate = "oblimin", fm="minres")

# Print results
fa

scree(random_slopes)

tab_model(model1b)

# MIDLUTEAL REF - separate random slopes
model1br <- lmer(DRSP_5 ~ perimenstrual_LH + earlylut_LH+periov_LH+midfol_LH +
              (1 + NON_ML | ID), data = AdultADHDDailyData)

summary(model1br)
ranova(model1br)
tab_model(model1br)

# EARLY LUT REF
model1c <- lmer(DRSP_5 ~periov_LH+ midfol_LH+perimenstrual_LH + midluteal_LH+
              (1 + periov_LH+ midfol_LH+perimenstrual_LH + midluteal_LH | ID), data = AdultADHDDailyData)

summary(model1c)

ranova(model1c)
check_outliers(model1c)
check_heteroscedasticity(model1c)
check_normality(model1c)

#Check Residual Distribution

residuals <- resid(model1c)
hist(residuals)


# Extract the random slopes for each level of the categorical variable
random_slopes <- ranef(model1c)$ID

# Remove Intercept

random_slopes <- random_slopes[, -1]

# Apply factor analysis to the correlation matrix
fa <- fa(r = random_slopes, nfactors = 2, rotate = "oblimin", fm="minchi")

# Print results
fa

scree(random_slopes)

tab_model(model1c)

# EARLY LUT REF 
model1cr <- lmer(DRSP_5 ~periov_LH+ midfol_LH+perimenstrual_LH + midluteal_LH+
              (1 + PERI_MF | ID), data = AdultADHDDailyData)

summary(model1cr)
ranova(model1cr)
tab_model(model1cr)


# PERIOV REF
model1d <- lmer(DRSP_5 ~midfol_LH+perimenstrual_LH + midluteal_LH+ earlylut_LH+
              (1 + midfol_LH+perimenstrual_LH + midluteal_LH+ earlylut_LH | ID), data = AdultADHDDailyData)

summary(model1d)
ranova(model1d)

tab_model(model1d)

# Extract the random slopes for each level of the categorical variable
random_slopes <- ranef(model1d)$ID

# Remove Intercept

random_slopes <- random_slopes[, -1]

# Apply factor analysis to the correlation matrix
fa <- fa(r = random_slopes, nfactors = 2, rotate = "oblimin", fm="minchi")

# Print results
fa

scree(random_slopes)

# PERIOV REF - new random
model1dr <- lmer(DRSP_5 ~midfol_LH+perimenstrual_LH + midluteal_LH+ earlylut_LH+
              (1 + PERI_MF + EL_ML | ID), data = AdultADHDDailyData)

summary(model1dr)
ranova(model1dr)
tab_model(model1dr)


```






## Model Fitting for Manuscript - Rejection Sensitivity 
```{r}

# PERIMENS REF
model1a <- lmer(DRSP_6 ~ midluteal_LH +earlylut_LH+periov_LH + midfol_LH + 
              (1 + midluteal_LH +earlylut_LH+periov_LH + midfol_LH  | ID), data = AdultADHDDailyData)

summary(model1a)
ranova(model1a)
check_outliers(model1a)
check_heteroscedasticity(model1a)
check_normality(model1a)

#Check Residual Distribution

residuals <- resid(model1a)
hist(residuals)


# Extract the random slopes for each level of the categorical variable
random_slopes <- ranef(model1a)$ID

# Remove Intercept

random_slopes <- random_slopes[, -1]

# Apply factor analysis to the correlation matrix
fa <- fa(r = random_slopes, nfactors = 2, rotate = "oblimin", fm="minres")

# Print results
fa

scree(random_slopes)


tab_model(model1a)

# PERIMENS REF 
model1ar <- lmer(DRSP_6 ~ midluteal_LH +earlylut_LH+periov_LH + midfol_LH + 
              (1 + NON_PERI  | ID), data = AdultADHDDailyData)

summary(model1ar)
ranova(model1ar)
tab_model(model1ar)


# MIDLUTEAL REF 
model1b <- lmer(DRSP_6 ~ perimenstrual_LH + earlylut_LH+periov_LH+midfol_LH +
              (1 + perimenstrual_LH + earlylut_LH+periov_LH+midfol_LH | ID), data = AdultADHDDailyData)

summary(model1b)

ranova(model1b)
check_outliers(model1b)
check_heteroscedasticity(model1b)
check_normality(model1b)

#Check Residual Distribution

residuals <- resid(model1b)
hist(residuals)


# Extract the random slopes for each level of the categorical variable
random_slopes <- ranef(model1b)$ID

# Remove Intercept

random_slopes <- random_slopes[, -1]

# Apply factor analysis to the correlation matrix
fa <- fa(r = random_slopes, nfactors = 2, rotate = "oblimin", fm="minres")

# Print results
fa

scree(random_slopes)

# NOTE: NEGATIVE FACTOR LOADING! How to deal? 


# MIDLUTEAL REF - separate random slopes
model1br <- lmer(DRSP_6 ~ perimenstrual_LH + earlylut_LH+periov_LH+midfol_LH +
              (1 + PERI_OV_EL | ID), data = AdultADHDDailyData)

summary(model1br)
ranova(model1br)
tab_model(model1br)

# EARLY LUT REF
model1c <- lmer(DRSP_6 ~periov_LH+ midfol_LH+perimenstrual_LH + midluteal_LH+
              (1 + perimenstrual_LH + earlylut_LH+periov_LH+midfol_LH| ID), data = AdultADHDDailyData)

summary(model1c)

ranova(model1c)
check_outliers(model1c)
check_heteroscedasticity(model1c)
check_normality(model1c)

#Check Residual Distribution

residuals <- resid(model1c)
hist(residuals)


# Extract the random slopes for each level of the categorical variable
random_slopes <- ranef(model1c)$ID

# Remove Intercept

random_slopes <- random_slopes[, -1]

# Apply factor analysis to the correlation matrix
fa <- fa(r = random_slopes, nfactors = 3, rotate = "oblimin", fm="minchi")

# Print results
fa

scree(random_slopes)

tab_model(model1c)

# EARLY LUT REF 
model1cr <- lmer(DRSP_6 ~periov_LH+ midfol_LH+perimenstrual_LH + midluteal_LH+
              (1  | ID), data = AdultADHDDailyData)

summary(model1cr)
ranova(model1cr)
tab_model(model1cr)


# PERIOV REF
model1d <- lmer(DRSP_6 ~midfol_LH+perimenstrual_LH + midluteal_LH+ earlylut_LH+
              (1 + midfol_LH+perimenstrual_LH + midluteal_LH+ earlylut_LH | ID), data = AdultADHDDailyData)

summary(model1d)
ranova(model1d)

tab_model(model1d)

# Extract the random slopes for each level of the categorical variable
random_slopes <- ranef(model1d)$ID

# Remove Intercept

random_slopes <- random_slopes[, -1]

# Apply factor analysis to the correlation matrix
fa <- fa(r = random_slopes, nfactors = 2, rotate = "oblimin", fm="minchi")

# Print results
fa

scree(random_slopes)

# PERIOV REF - new random
model1dr <- lmer(DRSP_6 ~midfol_LH+perimenstrual_LH + midluteal_LH+ earlylut_LH+
              (1 + midfol_LH+perimenstrual_LH   | ID), data = AdultADHDDailyData)

summary(model1dr)
ranova(model1dr)
tab_model(model1dr)

# FINAL MODELS: 

tab_model(model list here)


```




## Model Fitting for Manuscript - Anger/Irritability 
```{r}

# PERIMENS REF
model1a <- lmer(DRSP_7 ~ midluteal_LH +earlylut_LH+periov_LH + midfol_LH + 
              (1 + midluteal_LH +earlylut_LH+periov_LH + midfol_LH  | ID), data = AdultADHDDailyData)

summary(model1a)
ranova(model1a)
check_outliers(model1a)
check_heteroscedasticity(model1a)
check_normality(model1a)

#Check Residual Distribution

residuals <- resid(model1a)
hist(residuals)


# Extract the random slopes for each level of the categorical variable
random_slopes <- ranef(model1a)$ID

# Remove Intercept

random_slopes <- random_slopes[, -1]

# Apply factor analysis to the correlation matrix
fa <- fa(r = random_slopes, nfactors = 2, rotate = "oblimin", fm="minres")

# Print results
fa

scree(random_slopes)


tab_model(model1a)

# PERIMENS REF 
model1ar <- lmer(DRSP_7 ~ midluteal_LH +earlylut_LH+periov_LH + midfol_LH + 
              (1 + NON_PERI | ID), data = AdultADHDDailyData)

summary(model1ar)
ranova(model1ar)
tab_model(model1ar)


# MIDLUTEAL REF 
model1b <- lmer(DRSP_7 ~ perimenstrual_LH + earlylut_LH+periov_LH+midfol_LH +
              (1 + perimenstrual_LH + earlylut_LH+periov_LH+midfol_LH | ID), data = AdultADHDDailyData)

summary(model1b)

ranova(model1b)
check_outliers(model1b)
check_heteroscedasticity(model1b)
check_normality(model1b)

#Check Residual Distribution

residuals <- resid(model1b)
hist(residuals)


# Extract the random slopes for each level of the categorical variable
random_slopes <- ranef(model1b)$ID

# Remove Intercept

random_slopes <- random_slopes[, -1]

# Apply factor analysis to the correlation matrix
fa <- fa(r = random_slopes, nfactors = 2, rotate = "oblimin", fm="minres")

# Print results
fa

scree(random_slopes)

# NOTE: NEGATIVE FACTOR LOADING! How to deal? 

tab_model(model1b)

# MIDLUTEAL REF - separate random slopes
model1br <- lmer(DRSP_7 ~ perimenstrual_LH + earlylut_LH+periov_LH+midfol_LH +
              (1 + MF_EL_ML+ perimenstrual_LH| ID), data = AdultADHDDailyData)

summary(model1br)
ranova(model1br)
tab_model(model1br)

# EARLY LUT REF

model1c <- lmer(DRSP_7 ~periov_LH+ midfol_LH+perimenstrual_LH + midluteal_LH+
              (1 + periov_LH+ midfol_LH+perimenstrual_LH + midluteal_LH| ID), data = AdultADHDDailyData)

summary(model1c)

ranova(model1c)
check_outliers(model1c)
check_heteroscedasticity(model1c)
check_normality(model1c)

#Check Residual Distribution

residuals <- resid(model1c)
hist(residuals)


# Extract the random slopes for each level of the categorical variable
random_slopes <- ranef(model1c)$ID

# Remove Intercept

random_slopes <- random_slopes[, -1]

# Apply factor analysis to the correlation matrix
fa <- fa(r = random_slopes, nfactors = 3, rotate = "oblimin", fm="minchi")

# Print results
fa

scree(random_slopes)

tab_model(model1c)

# EARLY LUT REF 
model1cr <- lmer(DRSP_7 ~periov_LH+ midfol_LH+perimenstrual_LH + midluteal_LH+
              (1| ID), data = AdultADHDDailyData)

summary(model1cr)
ranova(model1cr)
tab_model(model1cr)


# PERIOV REF
model1d <- lmer(DRSP_7 ~midfol_LH+perimenstrual_LH + midluteal_LH+ earlylut_LH+
              (1 + midfol_LH+perimenstrual_LH + midluteal_LH+ earlylut_LH | ID), data = AdultADHDDailyData)

summary(model1d)
ranova(model1d)

tab_model(model1d)

# Extract the random slopes for each level of the categorical variable
random_slopes <- ranef(model1d)$ID

# Remove Intercept

random_slopes <- random_slopes[, -1]

# Apply factor analysis to the correlation matrix
fa <- fa(r = random_slopes, nfactors = 2, rotate = "oblimin", fm="minchi")

# Print results
fa

scree(random_slopes)

# PERIOV REF - new random
model1dr <- lmer(DRSP_7 ~midfol_LH+perimenstrual_LH + midluteal_LH+ earlylut_LH+
              (1 | ID), data = AdultADHDDailyData)

summary(model1dr)
ranova(model1dr)
tab_model(model1dr)

# FINAL MODELS: 

tab_model(model list here)


```













## Model Fitting for Manuscript - Interpersonal Conflict 
```{r}

# PERIMENS REF

model1a <- lmer(DRSP_8 ~ midluteal_LH +earlylut_LH+periov_LH + midfol_LH + 
              (1 + midluteal_LH +earlylut_LH+periov_LH + midfol_LH  | ID), data = AdultADHDDailyData)

summary(model1a)
ranova(model1a)
check_outliers(model1a)
check_heteroscedasticity(model1a)
check_normality(model1a)

#Check Residual Distribution

residuals <- resid(model1a)
hist(residuals)

# Extract the random slopes for each level of the categorical variable
random_slopes <- ranef(model1a)$ID

# Remove Intercept

random_slopes <- random_slopes[, -1]

# Apply factor analysis to the correlation matrix
fa <- fa(r = random_slopes, nfactors = 2, rotate = "oblimin", fm="minres")

# Print results
fa

scree(random_slopes)


tab_model(model1a)

# PERIMENS REF 
model1ar <- lmer(DRSP_8 ~ midluteal_LH +earlylut_LH+periov_LH + midfol_LH + 
              (1 + NON_PERI | ID), data = AdultADHDDailyData)

summary(model1ar)
ranova(model1ar)
tab_model(model1ar)


# MIDLUTEAL REF 
model1b <- lmer(DRSP_8 ~ perimenstrual_LH + earlylut_LH+periov_LH+midfol_LH +
              (1 + perimenstrual_LH + earlylut_LH+periov_LH+midfol_LH | ID), data = AdultADHDDailyData)

summary(model1b)

ranova(model1b)
check_outliers(model1b)
check_heteroscedasticity(model1b)
check_normality(model1b)

#Check Residual Distribution

residuals <- resid(model1b)
hist(residuals)


# Extract the random slopes for each level of the categorical variable
random_slopes <- ranef(model1b)$ID

# Remove Intercept

random_slopes <- random_slopes[, -1]

# Apply factor analysis to the correlation matrix
fa <- fa(r = random_slopes, nfactors = 2, rotate = "oblimin", fm="minres")

# Print results
fa

scree(random_slopes)

# NOTE: 

tab_model(model1b)

# MIDLUTEAL REF - separate random slopes
model1br <- lmer(DRSP_8 ~ perimenstrual_LH + earlylut_LH+periov_LH+midfol_LH +
              (1 | ID), data = AdultADHDDailyData)

summary(model1br)
ranova(model1br)
tab_model(model1br)

# EARLY LUT REF

model1c <- lmer(DRSP_8 ~periov_LH+ midfol_LH+perimenstrual_LH + midluteal_LH+
              (1 + periov_LH+ midfol_LH+perimenstrual_LH + midluteal_LH| ID), data = AdultADHDDailyData)

summary(model1c)

ranova(model1c)
check_outliers(model1c)
check_heteroscedasticity(model1c)
check_normality(model1c)

#Check Residual Distribution

residuals <- resid(model1c)
hist(residuals)


# Extract the random slopes for each level of the categorical variable
random_slopes <- ranef(model1c)$ID

# Remove Intercept

random_slopes <- random_slopes[, -1]

# Apply factor analysis to the correlation matrix
fa <- fa(r = random_slopes, nfactors = 2, rotate = "oblimin", fm="minchi")

# Print results
fa

scree(random_slopes)

tab_model(model1c)

# EARLY LUT REF 
model1cr <- lmer(DRSP_8 ~periov_LH+ midfol_LH+perimenstrual_LH + midluteal_LH+
              (1| ID), data = AdultADHDDailyData)

summary(model1cr)
ranova(model1cr)
tab_model(model1cr)


# PERIOV REF
model1d <- lmer(DRSP_8 ~midfol_LH+perimenstrual_LH + midluteal_LH+ earlylut_LH+
              (1 + midfol_LH+perimenstrual_LH + midluteal_LH+ earlylut_LH | ID), data = AdultADHDDailyData)

summary(model1d)
ranova(model1d)

tab_model(model1d)

# Extract the random slopes for each level of the categorical variable
random_slopes <- ranef(model1d)$ID

# Remove Intercept

random_slopes <- random_slopes[, -1]

# Apply factor analysis to the correlation matrix
fa <- fa(r = random_slopes, nfactors = 2, rotate = "oblimin", fm="minchi")

# Print results
fa

scree(random_slopes)

# PERIOV REF - new random
model1dr <- lmer(DRSP_8 ~midfol_LH+perimenstrual_LH + midluteal_LH+ earlylut_LH+
              (1 | ID), data = AdultADHDDailyData)

summary(model1dr)
ranova(model1dr)
tab_model(model1dr)


# FINAL MODELS: 

tab_model(model list here)


```


## Model Fitting for Manuscript - Overwhelm 
```{r}

# PERIMENS REF
model1a <- lmer(DRSP_16 ~ midluteal_LH +earlylut_LH+periov_LH + midfol_LH + 
              (1 + midluteal_LH +earlylut_LH+periov_LH + midfol_LH  | ID), data = AdultADHDDailyData)

summary(model1a)
ranova(model1a)
check_outliers(model1a)
check_heteroscedasticity(model1a)
check_normality(model1a)

#Check Residual Distribution

residuals <- resid(model1a)
hist(residuals)

# Extract the random slopes for each level of the categorical variable
random_slopes <- ranef(model1a)$ID

# Remove Intercept

random_slopes <- random_slopes[, -1]

# Apply factor analysis to the correlation matrix
fa <- fa(r = random_slopes, nfactors = 2, rotate = "oblimin", fm="minres")

# Print results
fa

scree(random_slopes)


tab_model(model1a) # USE THIS ONE

# PERIMENS REF 
model1ar <- lmer(DRSP_16 ~ midluteal_LH +earlylut_LH+periov_LH + midfol_LH + 
              (1 + EL_ML+ PERI_MF | ID), data = AdultADHDDailyData)

summary(model1ar)
ranova(model1ar)
tab_model(model1ar)


# MIDLUTEAL REF 
model1b <- lmer(DRSP_16 ~ perimenstrual_LH + earlylut_LH+periov_LH+midfol_LH +
              (1 + perimenstrual_LH + earlylut_LH+periov_LH+midfol_LH | ID), data = AdultADHDDailyData)

summary(model1b)

ranova(model1b)
check_outliers(model1b)
check_heteroscedasticity(model1b)
check_normality(model1b)

#Check Residual Distribution

residuals <- resid(model1b)
hist(residuals)


# Extract the random slopes for each level of the categorical variable
random_slopes <- ranef(model1b)$ID

# Remove Intercept

random_slopes <- random_slopes[, -1]

# Apply factor analysis to the correlation matrix
fa <- fa(r = random_slopes, nfactors = 2, rotate = "oblimin", fm="minres")

# Print results
fa

scree(random_slopes)

# NOTE: 

tab_model(model1b)

# MIDLUTEAL REF - separate random slopes
model1br <- lmer(DRSP_16 ~ perimenstrual_LH + earlylut_LH+periov_LH+midfol_LH +
              (1 + PERI_EL+ MF_OV| ID), data = AdultADHDDailyData)

summary(model1br)
ranova(model1br)
tab_model(model1br) # USE THIS ONE

# EARLY LUT REF

model1c <- lmer(DRSP_16 ~periov_LH+ midfol_LH+perimenstrual_LH + midluteal_LH+
              (1 + periov_LH+ midfol_LH+perimenstrual_LH + midluteal_LH| ID), data = AdultADHDDailyData)

summary(model1c)

ranova(model1c)
check_outliers(model1c)
check_heteroscedasticity(model1c)
check_normality(model1c)

#Check Residual Distribution

residuals <- resid(model1c)
hist(residuals)


# Extract the random slopes for each level of the categorical variable
random_slopes <- ranef(model1c)$ID

# Remove Intercept

random_slopes <- random_slopes[, -1]

# Apply factor analysis to the correlation matrix
fa <- fa(r = random_slopes, nfactors = 2, rotate = "oblimin", fm="minchi")

# Print results
fa

scree(random_slopes)

tab_model(model1c)

# EARLY LUT REF 
model1cr <- lmer(DRSP_16 ~periov_LH+ midfol_LH+perimenstrual_LH + midluteal_LH+
              (1+MF_OV+ ML_PERI| ID), data = AdultADHDDailyData)

summary(model1cr)
ranova(model1cr)
tab_model(model1cr)


# PERIOV REF
model1d <- lmer(DRSP_16 ~midfol_LH+perimenstrual_LH + midluteal_LH+ earlylut_LH+
              (1 + midfol_LH+perimenstrual_LH + midluteal_LH+ earlylut_LH | ID), data = AdultADHDDailyData)

summary(model1d)
ranova(model1d)

tab_model(model1d)

# Extract the random slopes for each level of the categorical variable
random_slopes <- ranef(model1d)$ID

# Remove Intercept

random_slopes <- random_slopes[, -1]

# Apply factor analysis to the correlation matrix
fa <- fa(r = random_slopes, nfactors = 2, rotate = "oblimin", fm="minchi")

# Print results
fa

scree(random_slopes)

# PERIOV REF - new random
model1dr <- lmer(DRSP_16 ~midfol_LH+perimenstrual_LH + midluteal_LH+ earlylut_LH+
              (1 +PERI_MF + EL_ML| ID), data = AdultADHDDailyData)

summary(model1dr)
ranova(model1dr)
tab_model(model1dr) # Use this One


# FINAL MODELS: 

tab_model(model list here)


```

## Model Fitting for Manuscript - Out of Control 
```{r}

# PERIMENS REF
model1a <- lmer(DRSP_17 ~ midluteal_LH +earlylut_LH+periov_LH + midfol_LH + 
              (1 + midluteal_LH +earlylut_LH+periov_LH + midfol_LH  | ID), data = AdultADHDDailyData)

summary(model1a)
ranova(model1a)
check_outliers(model1a)
check_heteroscedasticity(model1a)
check_normality(model1a)

#Check Residual Distribution

residuals <- resid(model1a)
hist(residuals)

# Extract the random slopes for each level of the categorical variable
random_slopes <- ranef(model1a)$ID

# Remove Intercept

random_slopes <- random_slopes[, -1]

# Apply factor analysis to the correlation matrix
fa <- fa(r = random_slopes, nfactors = 2, rotate = "oblimin", fm="minres")

# Print results
fa

scree(random_slopes)


tab_model(model1a) # USE THIS ONE

# PERIMENS REF 
model1ar <- lmer(DRSP_17 ~ midluteal_LH +earlylut_LH+periov_LH + midfol_LH + 
              (1 | ID), data = AdultADHDDailyData)

summary(model1ar)
ranova(model1ar)
tab_model(model1ar) # Use this one


# MIDLUTEAL REF 
model1b <- lmer(DRSP_17 ~ perimenstrual_LH + earlylut_LH+periov_LH+midfol_LH +
              (1  | ID), data = AdultADHDDailyData)

summary(model1b)

ranova(model1b)
check_outliers(model1b)
check_heteroscedasticity(model1b)
check_normality(model1b)

#Check Residual Distribution

residuals <- resid(model1b)
hist(residuals)

tab_model(model1b)

# EARLY LUT REF

model1c <- lmer(DRSP_17 ~periov_LH+ midfol_LH+perimenstrual_LH + midluteal_LH+
              (1 + periov_LH+ midfol_LH+perimenstrual_LH + midluteal_LH| ID), data = AdultADHDDailyData)

summary(model1c)

ranova(model1c)
check_outliers(model1c)
check_heteroscedasticity(model1c)
check_normality(model1c)

#Check Residual Distribution

residuals <- resid(model1c)
hist(residuals)


# Extract the random slopes for each level of the categorical variable
random_slopes <- ranef(model1c)$ID

# Remove Intercept

random_slopes <- random_slopes[, -1]

# Apply factor analysis to the correlation matrix
fa <- fa(r = random_slopes, nfactors = 2, rotate = "oblimin", fm="minchi")

# Print results
fa

scree(random_slopes)

tab_model(model1c)

# EARLY LUT REF 
model1cr <- lmer(DRSP_17 ~periov_LH+ midfol_LH+perimenstrual_LH + midluteal_LH+
              (1+NON_EL| ID), data = AdultADHDDailyData)

summary(model1cr)
ranova(model1cr)
tab_model(model1cr) # use this one


# PERIOV REF
model1d <- lmer(DRSP_17 ~midfol_LH+perimenstrual_LH + midluteal_LH+ earlylut_LH+
              (1 + midfol_LH+perimenstrual_LH + midluteal_LH+ earlylut_LH | ID), data = AdultADHDDailyData)

summary(model1d)
ranova(model1d)

tab_model(model1d)

# Extract the random slopes for each level of the categorical variable
random_slopes <- ranef(model1d)$ID

# Remove Intercept

random_slopes <- random_slopes[, -1]

# Apply factor analysis to the correlation matrix
fa <- fa(r = random_slopes, nfactors = 2, rotate = "oblimin", fm="minchi")

# Print results
fa

scree(random_slopes)

# PERIOV REF - new random
model1dr <- lmer(DRSP_17 ~midfol_LH+perimenstrual_LH + midluteal_LH+ earlylut_LH+
              (1 +midfol_LH+EL_ML_PERI| ID), data = AdultADHDDailyData)

summary(model1dr)
ranova(model1dr)
tab_model(model1dr) # Use this One


```














## Model Fitting for Manuscript - LESS INTEREST;
```{r}

# PERIMENS REF
model1a <- lmer(DRSP_9 ~ midluteal_LH +earlylut_LH+periov_LH + midfol_LH + 
              (1 + midluteal_LH +earlylut_LH+periov_LH + midfol_LH  | ID), data = AdultADHDDailyData)

summary(model1a)
ranova(model1a)
check_outliers(model1a)
check_heteroscedasticity(model1a)
check_normality(model1a)

#Check Residual Distribution

residuals <- resid(model1a)
hist(residuals)

# Extract the random slopes for each level of the categorical variable
random_slopes <- ranef(model1a)$ID

# Remove Intercept

random_slopes <- random_slopes[, -1]

# Apply factor analysis to the correlation matrix
fa <- fa(r = random_slopes, nfactors = 2, rotate = "oblimin", fm="minres")

# Print results
fa

scree(random_slopes)


tab_model(model1a)

# PERIMENS REF 
model1ar <- lmer(DRSP_9 ~ midluteal_LH +earlylut_LH+periov_LH + midfol_LH + 
              (1 + EL_ML + MF_OV | ID), data = AdultADHDDailyData)

summary(model1ar)
ranova(model1ar)
tab_model(model1ar) # use this one


# MIDLUTEAL REF 
model1b <- lmer(DRSP_9 ~ perimenstrual_LH + earlylut_LH+periov_LH+midfol_LH +
              (1 + perimenstrual_LH + earlylut_LH+periov_LH+midfol_LH | ID), data = AdultADHDDailyData)

summary(model1b)

ranova(model1b)
check_outliers(model1b)
check_heteroscedasticity(model1b)
check_normality(model1b)

#Check Residual Distribution

residuals <- resid(model1b)
hist(residuals)


# Extract the random slopes for each level of the categorical variable
random_slopes <- ranef(model1b)$ID

# Remove Intercept

random_slopes <- random_slopes[, -1]

# Apply factor analysis to the correlation matrix
fa <- fa(r = random_slopes, nfactors = 2, rotate = "oblimin", fm="minres")

# Print results
fa

scree(random_slopes)

# NOTE: NEGATIVE FACTOR LOADING! How to deal? 

tab_model(model1b)

# MIDLUTEAL REF - separate random slopes
model1br <- lmer(DRSP_9 ~ perimenstrual_LH + earlylut_LH+periov_LH+midfol_LH +
              (1 + OV_EL + perimenstrual_LH + midfol_LH | ID), data = AdultADHDDailyData)

summary(model1br)
ranova(model1br)
tab_model(model1br)

# EARLY LUT REF
model1c <- lmer(DRSP_9 ~periov_LH+ midfol_LH+perimenstrual_LH + midluteal_LH+
              (1 + periov_LH+ midfol_LH+perimenstrual_LH + midluteal_LH| ID), data = AdultADHDDailyData)

summary(model1c)

ranova(model1c)
check_outliers(model1c)
check_heteroscedasticity(model1c)
check_normality(model1c)

#Check Residual Distribution

residuals <- resid(model1c)
hist(residuals)


# Extract the random slopes for each level of the categorical variable
random_slopes <- ranef(model1c)$ID

# Remove Intercept

random_slopes <- random_slopes[, -1]

# Apply factor analysis to the correlation matrix
fa <- fa(r = random_slopes, nfactors = 2, rotate = "oblimin", fm="minchi")

# Print results
fa

scree(random_slopes)

tab_model(model1c)

# EARLY LUT REF 
model1cr <- lmer(DRSP_9 ~periov_LH+ midfol_LH+perimenstrual_LH + midluteal_LH+
              (1 +MF_OV + EL_ML | ID), data = AdultADHDDailyData)

summary(model1cr)
ranova(model1cr)
tab_model(model1cr)


# PERIOV REF

model1d <- lmer(DRSP_9 ~midfol_LH+perimenstrual_LH + midluteal_LH+ earlylut_LH+
              (1 + midfol_LH+perimenstrual_LH + midluteal_LH+ earlylut_LH | ID), data = AdultADHDDailyData)

summary(model1d)
ranova(model1d)

tab_model(model1d)

# Extract the random slopes for each level of the categorical variable
random_slopes <- ranef(model1d)$ID

# Remove Intercept

random_slopes <- random_slopes[, -1]

# Apply factor analysis to the correlation matrix
fa <- fa(r = random_slopes, nfactors = 2, rotate = "oblimin", fm="minchi")

# Print results
fa

scree(random_slopes)

# PERIOV REF - new random
model1dr <- lmer(DRSP_9 ~midfol_LH+perimenstrual_LH + midluteal_LH+ earlylut_LH+
              (1 + PERI_MF + EL_ML  | ID), data = AdultADHDDailyData)

summary(model1dr)
ranova(model1dr)
tab_model(model1dr)


# FINAL MODELS: 

tab_model(model list here)

```
























##ADHD SYMPTOM MODELS AND GRAPHS

### Inattention models
```{r}
#2/2/23 effects of phase on daily symptoms
# model 2: predicting a linear outcome from one predictor, random intercepts, no cycle vars


#Midfol as reference group
Phase_IA_MF <- lmerTest::lmer(IA_Count ~ periov_LH + earlylut_LH + midluteal_LH + perimenstrual_LH
                                     +(1|ID),
                                     data = AdultADHDDailyData) 
summary(Phase_IA_MF)
#PeriOv as reference group
Phase_IA_PO <- lmerTest::lmer(IA_Count ~ midfol_LH + earlylut_LH + midluteal_LH + perimenstrual_LH
                                     +(1|ID),
                                     data = AdultADHDDailyData) 
summary(Phase_IA_PO)
#EarlyLut as reference group
Phase_IA_EL <- lmerTest::lmer(IA_Count ~ midfol_LH + periov_LH + midluteal_LH + perimenstrual_LH
                                     +(1|ID),
                                     data = AdultADHDDailyData) 
summary(Phase_IA_EL)
#Midluteal as reference group
Phase_IA_ML <- lmerTest::lmer(IA_Count ~ midfol_LH + periov_LH +earlylut_LH + perimenstrual_LH
                                     +(1|ID),
                                     data = AdultADHDDailyData) 
summary(Phase_IA_ML)
#Perimenstrual as reference group
Phase_IA_PM <- lmerTest::lmer(IA_Count ~ midfol_LH + periov_LH +earlylut_LH + midluteal_LH
                                     +(1|ID),
                                     data = AdultADHDDailyData) 
summary(Phase_IA_PM)

#Hormone effects
IA_hormones <- lmerTest::lmer(IA_Count ~ Estradiol.d + Progesterone.d + Estradiol.d*Progesterone.d
                                     +(1 |ID),
                                     data = AdultADHDDailyData) 
summary(IA_hormones)


```
```{r}
#Plot Daily Data by Phase
#set up labels
AdultADHDDailyData$cyclephase_names <- factor(AdultADHDDailyData$cyclephase_LH, levels = c(1,2,3,4,5), labels = c("PO", "EL", "ML", "PM", "MF"))

#person-mean-center
data_for_plot1a <- AdultADHDDailyData %>% group_by(ID, cyclephase_names) %>% 
  summarize(IA_Count.m=mean(IA_Count.m),
            IAphase.m = mean(IA_Count, na.rm = TRUE),
            IAphase.d = IAphase.m - IA_Count.m)%>%
filter(!is.na(cyclephase_names))

plot1a <- data_for_plot1a %>% 
  group_by(cyclephase_names) %>%
  summarize(grand.m.IA_Count.d = mean(IAphase.d, na.rm=T),
            se=sd(IAphase.d, na.rm=T)/sqrt(n())) %>%
  #can save the above code into a separate dataset if preferred (dont have to do it in one line w/ ggplot)
  ggplot(aes(x=cyclephase_names, y=grand.m.IA_Count.d))+
  geom_line(group=1)+
  ##everything from here down is just formatting
  scale_x_discrete(labels=c("PO" = "Periovulatory",
                            "EL" = "Earlyluteal",
                            "ML" = "Midluteal",
                            "PM" = "Perimenstrual",
                            "MF" = "Midfollicular" ))+
  geom_errorbar(aes(ymin=grand.m.IA_Count.d-se, 
                    ymax=grand.m.IA_Count.d+se), 
                size=0.5, width=0.5, position=position_dodge())+
  geom_hline(yintercept=0.0, color="red", linetype="dashed")+
  theme_bw()+
  xlab("Cycle Phase")+
  ylab("Person-Centered Inattention")
#run plot1a in console to see plot
plot1a
```
### Impulsivity models
```{r}
#2/2/23 effects of phase on daily symptoms
# model 2: predicting a linear outcome from one predictor, random intercepts, no cycle vars
badhormones <- c(206, 214, 221, 228)

#save new dataframe without all excluded participants
AdultADHDDailyData <- AdultADHDDailyData %>% 
  filter(!ID %in% badhormones) 

#Midfol as reference group
Phase_Imp_MF <- lmerTest::lmer(Imp_Count ~ periov_LH + earlylut_LH + midluteal_LH + perimenstrual_LH
                                     +(1|ID),
                                     data = AdultADHDDailyData) 
summary(Phase_Imp_MF)
#PeriOv as reference group
Phase_Imp_PO <- lmerTest::lmer(Imp_Count ~ midfol_LH + earlylut_LH + midluteal_LH + perimenstrual_LH
                                     +(1|ID),
                                     data = AdultADHDDailyData) 
summary(Phase_Imp_PO)
#EarlyLut as reference group
Phase_Imp_EL <- lmerTest::lmer(Imp_Count ~ midfol_LH + periov_LH + midluteal_LH + perimenstrual_LH
                                     +(1|ID),
                                     data = AdultADHDDailyData) 
summary(Phase_Imp_EL)
#Midluteal as reference group
Phase_Imp_ML <- lmerTest::lmer(Imp_Count ~ midfol_LH + periov_LH +earlylut_LH + perimenstrual_LH
                                     +(1|ID),
                                     data = AdultADHDDailyData) 
summary(Phase_Imp_ML)
#Perimenstrual as reference group
Phase_Imp_PM <- lmerTest::lmer(Imp_Count ~ midfol_LH + periov_LH +earlylut_LH + midluteal_LH
                                     +(1|ID),
                                     data = AdultADHDDailyData) 
summary(Phase_Imp_PM)

#Hormone effects
Imp_hormones <- lmerTest::lmer(Imp_Count ~ Estradiol.d + Progesterone.d + Estradiol.d*Progesterone.d
                                     +(1 |ID),
                                     data = AdultADHDDailyData) 
summary(Imp_hormones)
```
```{r}
#Plot Daily Data by Phase
#set up labels
AdultADHDDailyData$cyclephase_names <- factor(AdultADHDDailyData$cyclephase_LH, levels = c(1,2,3,4,5), labels = c("PO", "EL", "ML", "PM", "MF"))

#person-mean-center
data_for_plot1a <- AdultADHDDailyData %>% group_by(ID, cyclephase_names) %>% 
  summarize(Imp_Count.m=mean(Imp_Count.m),
            Impphase.m = mean(Imp_Count, na.rm = TRUE),
            Impphase.d = Impphase.m - Imp_Count.m)%>%
filter(!is.na(cyclephase_names))

plot1a <- data_for_plot1a %>% 
  group_by(cyclephase_names) %>%
  summarize(grand.m.Imp_Count.d = mean(Impphase.d, na.rm=T),
            se=sd(Impphase.d, na.rm=T)/sqrt(n())) %>%
  #can save the above code into a separate dataset if preferred (dont have to do it in one line w/ ggplot)
  ggplot(aes(x=cyclephase_names, y=grand.m.Imp_Count.d))+
  geom_line(group=1)+
  ##everything from here down is just formatting
  scale_x_discrete(labels=c("PO" = "Periovulatory",
                            "EL" = "Earlyluteal",
                            "ML" = "Midluteal",
                            "PM" = "Perimenstrual",
                            "MF" = "Midfollicular" ))+
  geom_errorbar(aes(ymin=grand.m.Imp_Count.d-se, 
                    ymax=grand.m.Imp_Count.d+se), 
                size=0.5, width=0.5, position=position_dodge())+
  geom_hline(yintercept=0.0, color="red", linetype="dashed")+
  theme_bw()+
  xlab("Cycle Phase")+
  ylab("Person-Centered Impuksivity")
#run plot1a in console to see plot
plot1a
```
### Hyperactivity models
```{r}
#2/2/23 effects of phase on daily symptoms
# model 2: predicting a linear outcome from one predictor, random intercepts, no cycle vars
badhormones <- c(206, 214, 221, 228)

#save new dataframe without all excluded participants
AdultADHDDailyData <- AdultADHDDailyData %>% 
  filter(!ID %in% badhormones) 

#Midfol as reference group
Phase_Hyp_MF <- lmerTest::lmer(Hyp_Count ~ periov_LH + earlylut_LH + midluteal_LH + perimenstrual_LH
                                     +(1|ID),
                                     data = AdultADHDDailyData) 
summary(Phase_Hyp_MF)
#PeriOv as reference group
Phase_Hyp_PO <- lmerTest::lmer(Hyp_Count ~ midfol_LH + earlylut_LH + midluteal_LH + perimenstrual_LH
                                     +(1|ID),
                                     data = AdultADHDDailyData) 
summary(Phase_Hyp_PO)
#EarlyLut as reference group
Phase_Hyp_EL <- lmerTest::lmer(Hyp_Count ~ midfol_LH + periov_LH + midluteal_LH + perimenstrual_LH
                                     +(1|ID),
                                     data = AdultADHDDailyData) 
summary(Phase_Hyp_EL)
#Midluteal as reference group
Phase_Hyp_ML <- lmerTest::lmer(Hyp_Count ~ midfol_LH + periov_LH +earlylut_LH + perimenstrual_LH
                                     +(1|ID),
                                     data = AdultADHDDailyData) 
summary(Phase_Hyp_ML)
#Perimenstrual as reference group
Phase_Hyp_PM <- lmerTest::lmer(Hyp_Count ~ midfol_LH + periov_LH +earlylut_LH + midluteal_LH
                                     +(1|ID),
                                     data = AdultADHDDailyData) 
summary(Phase_Hyp_PM)

#Hormone effects
Hyp_hormones <- lmerTest::lmer(Hyp_Count ~ Estradiol.d + Progesterone.d + Estradiol.d*Progesterone.d
                                     +(1 |ID),
                                     data = AdultADHDDailyData) 
summary(Hyp_hormones)
```
```{r}
#Plot Daily Data by Phase
#set up labels
AdultADHDDailyData$cyclephase_names <- factor(AdultADHDDailyData$cyclephase_LH, levels = c(1,2,3,4,5), labels = c("PO", "EL", "ML", "PM", "MF"))

#person-mean-center
data_for_plot1a <- AdultADHDDailyData %>% group_by(ID, cyclephase_names) %>% 
  summarize(Hyp_Count.m=mean(Hyp_Count.m),
            Hypphase.m = mean(Hyp_Count, na.rm = TRUE),
            Hypphase.d = Hypphase.m - Hyp_Count.m)%>%
filter(!is.na(cyclephase_names))

plot1a <- data_for_plot1a %>% 
  group_by(cyclephase_names) %>%
  summarize(grand.m.Hyp_Count.d = mean(Hypphase.d, na.rm=T),
            se=sd(Hypphase.d, na.rm=T)/sqrt(n())) %>%
  #can save the above code into a separate dataset if preferred (dont have to do it in one line w/ ggplot)
  ggplot(aes(x=cyclephase_names, y=grand.m.Hyp_Count.d))+
  geom_line(group=1)+
  ##everything from here down is just formatting
  scale_x_discrete(labels=c("PO" = "Periovulatory",
                            "EL" = "Earlyluteal",
                            "ML" = "Midluteal",
                            "PM" = "Perimenstrual",
                            "MF" = "Midfollicular" ))+
  geom_errorbar(aes(ymin=grand.m.Hyp_Count.d-se, 
                    ymax=grand.m.Hyp_Count.d+se), 
                size=0.5, width=0.5, position=position_dodge())+
  geom_hline(yintercept=0.0, color="red", linetype="dashed")+
  theme_bw()+
  xlab("Cycle Phase")+
  ylab("Person-Centered Hyperactivity")
#run plot1a in console to see plot
plot1a
```





##EXECUTIVE FUNCTION MODELS AND GRAPHS

### Pinball Models (Working Memory)
```{r}
#2/2/23 effects of phase on daily symptoms
# model 2: predicting a linear outcome from one predictor, random intercepts, no cycle vars
badhormones <- c(206, 214, 221, 228)

#save new dataframe without all excluded participants
AdultADHDDailyData <- AdultADHDDailyData %>% 
  filter(!ID %in% badhormones) 

#Midfol as reference group
Phase_pinball_MF <- lmerTest::lmer(RES_pinball ~ periov_LH + earlylut_LH + midluteal_LH + perimenstrual_LH
                                     +(1|ID),
                                     data = AdultADHDDailyData) 
summary(Phase_pinball_MF)
#PeriOv as reference group
Phase_pinball_PO <- lmerTest::lmer(RES_pinball ~ midfol_LH + earlylut_LH + midluteal_LH + perimenstrual_LH
                                     +(1|ID),
                                     data = AdultADHDDailyData) 
summary(Phase_pinball_PO)
#EarlyLut as reference group
Phase_pinball_EL <- lmerTest::lmer(RES_pinball ~ midfol_LH + periov_LH + midluteal_LH + perimenstrual_LH
                                     +(1|ID),
                                     data = AdultADHDDailyData) 
summary(Phase_pinball_EL)
#Midluteal as reference group
Phase_pinball_ML <- lmerTest::lmer(RES_pinball ~ midfol_LH + periov_LH +earlylut_LH + perimenstrual_LH
                                     +(1|ID),
                                     data = AdultADHDDailyData) 
summary(Phase_pinball_ML)
#Perimenstrual as reference group
Phase_pinball_PM <- lmerTest::lmer(RES_pinball ~ midfol_LH + periov_LH +earlylut_LH + midluteal_LH
                                     +(1|ID),
                                     data = AdultADHDDailyData) 
summary(Phase_pinball_PM)

#Hormone effects
pinball_hormones <- lmerTest::lmer(RES_pinball ~ Estradiol.d + Progesterone.d + Estradiol.d*Progesterone.d
                                     +(1 |ID),
                                     data = AdultADHDDailyData) 
summary(pinball_hormones)
```
```{r}
#Plot Daily Data by Phase
#set up labels
AdultADHDDailyData$cyclephase_names <- factor(AdultADHDDailyData$cyclephase_LH, levels = c(1,2,3,4,5), labels = c("PO", "EL", "ML", "PM", "MF"))

#person-mean-center
data_for_plot1a <- AdultADHDDailyData %>% group_by(ID, cyclephase_names) %>% 
  summarize(score_pinball.m=mean(score_pinball.m),
            pinballphase.m = mean(score_pinball, na.rm = TRUE),
            pinballphase.d = pinballphase.m - score_pinball.m)%>%
filter(!is.na(cyclephase_names))

plot1a <- data_for_plot1a %>% 
  group_by(cyclephase_names) %>%
  summarize(grand.m.score_pinball.d = mean(pinballphase.d, na.rm=T),
            se=sd(pinballphase.d, na.rm=T)/sqrt(n())) %>%
  #can save the above code into a separate dataset if preferred (dont have to do it in one line w/ ggplot)
  ggplot(aes(x=cyclephase_names, y=grand.m.score_pinball.d))+
  geom_line(group=1)+
  ##everything from here down is just formatting
  scale_x_discrete(labels=c("PO" = "Periovulatory",
                            "EL" = "Earlyluteal",
                            "ML" = "Midluteal",
                            "PM" = "Perimenstrual",
                            "MF" = "Midfollicular" ))+
  geom_errorbar(aes(ymin=grand.m.score_pinball.d-se, 
                    ymax=grand.m.score_pinball.d+se), 
                size=0.5, width=0.5, position=position_dodge())+
  geom_hline(yintercept=0.0, color="red", linetype="dashed")+
  theme_bw()+
  xlab("Cycle Phase")+
  ylab("Person-Centered Pinball Score")
#run plot1a in console to see plot
plot1a
```
### Robot Models (Response Inhibition)
```{r}
#2/2/23 effects of phase on daily symptoms
# model 2: predicting a linear outcome from one predictor, random intercepts, no cycle vars
badhormones <- c(206, 214, 221, 228)

#save new dataframe without all excluded participants
AdultADHDDailyData <- AdultADHDDailyData %>% 
  filter(!ID %in% badhormones) 

#Midfol as reference group
Phase_robot_MF <- lmerTest::lmer(RES_robot ~ periov_LH + earlylut_LH + midluteal_LH + perimenstrual_LH
                                     +(1|ID),
                                     data = AdultADHDDailyData) 
summary(Phase_robot_MF)
#PeriOv as reference group
Phase_robot_PO <- lmerTest::lmer(RES_robot ~ midfol_LH + earlylut_LH + midluteal_LH + perimenstrual_LH
                                     +(1|ID),
                                     data = AdultADHDDailyData) 
summary(Phase_robot_PO)
#EarlyLut as reference group
Phase_robot_EL <- lmerTest::lmer(RES_robot ~ midfol_LH + periov_LH + midluteal_LH + perimenstrual_LH
                                     +(1|ID),
                                     data = AdultADHDDailyData) 
summary(Phase_robot_EL)
#Midluteal as reference group
Phase_robot_ML <- lmerTest::lmer(RES_robot ~ midfol_LH + periov_LH +earlylut_LH + perimenstrual_LH
                                     +(1|ID),
                                     data = AdultADHDDailyData) 
summary(Phase_robot_ML)
#Perimenstrual as reference group
Phase_robot_PM <- lmerTest::lmer(RES_robot ~ midfol_LH + periov_LH +earlylut_LH + midluteal_LH
                                     +(1|ID),
                                     data = AdultADHDDailyData) 
summary(Phase_robot_PM)

#Hormone effects
robot_hormones <- lmerTest::lmer(RES_robot ~ Estradiol.d + Progesterone.d + Estradiol.d*Progesterone.d
                                     +(1 |ID),
                                     data = AdultADHDDailyData) 
summary(robot_hormones)
```
```{r}
#Plot Daily Data by Phase
#set up labels
AdultADHDDailyData$cyclephase_names <- factor(AdultADHDDailyData$cyclephase_LH, levels = c(1,2,3,4,5), labels = c("PO", "EL", "ML", "PM", "MF"))

#person-mean-center
data_for_plot1a <- AdultADHDDailyData %>% group_by(ID, cyclephase_names) %>% 
  summarize(RES_robot.m=mean(RES_robot.m),
            robotphase.m = mean(RES_robot, na.rm = TRUE),
            robotphase.d = robotphase.m - RES_robot.m)%>%
filter(!is.na(cyclephase_names))

plot1a <- data_for_plot1a %>% 
  group_by(cyclephase_names) %>%
  summarize(grand.m.RES_robot.d = mean(robotphase.d, na.rm=T),
            se=sd(robotphase.d, na.rm=T)/sqrt(n())) %>%
  #can save the above code into a separate dataset if preferred (dont have to do it in one line w/ ggplot)
  ggplot(aes(x=cyclephase_names, y=grand.m.RES_robot.d))+
  geom_line(group=1)+
  ##everything from here down is just formatting
  scale_x_discrete(labels=c("PO" = "Periovulatory",
                            "EL" = "Earlyluteal",
                            "ML" = "Midluteal",
                            "PM" = "Perimenstrual",
                            "MF" = "Midfollicular" ))+
  geom_errorbar(aes(ymin=grand.m.RES_robot.d-se, 
                    ymax=grand.m.RES_robot.d+se), 
                size=0.5, width=0.5, position=position_dodge())+
  geom_hline(yintercept=0.0, color="red", linetype="dashed")+
  theme_bw()+
  xlab("Cycle Phase")+
  ylab("Person-Centered Robot Score")
#run plot1a in console to see plot
plot1a
```
### BDEFS_RI models
```{r}
#2/2/23 effects of phase on daily symptoms
# model 2: predicting a linear outcome from one predictor, random intercepts, no cycle vars
badhormones <- c(206, 214, 221, 228)

#save new dataframe without all excluded participants
AdultADHDDailyData <- AdultADHDDailyData %>% 
  filter(!ID %in% badhormones) 

#Midfol as reference group
Phase_RI_MF <- lmerTest::lmer(BDEFS_RI_avg ~ periov_LH + earlylut_LH + midluteal_LH + perimenstrual_LH
                                     +(1|ID),
                                     data = AdultADHDDailyData) 
summary(Phase_RI_MF)
#PeriOv as reference group
Phase_RI_PO <- lmerTest::lmer(BDEFS_RI_avg ~ midfol_LH + earlylut_LH + midluteal_LH + perimenstrual_LH
                                     +(1|ID),
                                     data = AdultADHDDailyData) 
summary(Phase_RI_PO)
#EarlyLut as reference group
Phase_RI_EL <- lmerTest::lmer(BDEFS_RI_avg ~ midfol_LH + periov_LH + midluteal_LH + perimenstrual_LH
                                     +(1|ID),
                                     data = AdultADHDDailyData) 
summary(Phase_RI_EL)
#Midluteal as reference group
Phase_RI_ML <- lmerTest::lmer(BDEFS_RI_avg ~ midfol_LH + periov_LH +earlylut_LH + perimenstrual_LH
                                     +(1|ID),
                                     data = AdultADHDDailyData) 
summary(Phase_RI_ML)
#Perimenstrual as reference group
Phase_RI_PM <- lmerTest::lmer(BDEFS_RI_avg ~ midfol_LH + periov_LH +earlylut_LH + midluteal_LH
                                     +(1|ID),
                                     data = AdultADHDDailyData) 
summary(Phase_RI_PM)

#Hormone effects
RI_hormones <- lmerTest::lmer(BDEFS_RI_avg ~ Estradiol.d + Progesterone.d + Estradiol.d*Progesterone.d
                                     +(1 |ID),
                                     data = AdultADHDDailyData) 
summary(RI_hormones)
```
```{r}
#Plot Daily Data by Phase
#set up labels
AdultADHDDailyData$cyclephase_names <- factor(AdultADHDDailyData$cyclephase_LH, levels = c(1,2,3,4,5), labels = c("PO", "EL", "ML", "PM", "MF"))

#person-mean-center
data_for_plot1a <- AdultADHDDailyData %>% group_by(ID, cyclephase_names) %>% 
  summarize(BDEFS_RI_avg.m=mean(BDEFS_RI_avg.m),
            BDEFS_RIphase.m = mean(BDEFS_RI_avg, na.rm = TRUE),
            BDEFS_RIphase.d = BDEFS_RIphase.m - BDEFS_RI_avg.m)%>%
filter(!is.na(cyclephase_names))

plot1a <- data_for_plot1a %>% 
  group_by(cyclephase_names) %>%
  summarize(grand.m.BDEFS_RI_avg.d = mean(BDEFS_RIphase.d, na.rm=T),
            se=sd(BDEFS_RIphase.d, na.rm=T)/sqrt(n())) %>%
  #can save the above code into a separate dataset if preferred (dont have to do it in one line w/ ggplot)
  ggplot(aes(x=cyclephase_names, y=grand.m.BDEFS_RI_avg.d))+
  geom_line(group=1)+
  ##everything from here down is just formatting
  scale_x_discrete(labels=c("PO" = "Periovulatory",
                            "EL" = "Earlyluteal",
                            "ML" = "Midluteal",
                            "PM" = "Perimenstrual",
                            "MF" = "Midfollicular" ))+
  geom_errorbar(aes(ymin=grand.m.BDEFS_RI_avg.d-se, 
                    ymax=grand.m.BDEFS_RI_avg.d+se), 
                size=0.5, width=0.5, position=position_dodge())+
  geom_hline(yintercept=0.0, color="red", linetype="dashed")+
  theme_bw()+
  xlab("Cycle Phase")+
  ylab("Person-Centered BDEFS Response Inhibition")
#run plot1a in console to see plot
plot1a
```
### BDEFS_WM Models
```{r}
#2/2/23 effects of phase on daily symptoms
# model 2: predicting a linear outcome from one predictor, random intercepts, no cycle vars
badhormones <- c(206, 214, 221, 228)

#save new dataframe without all excluded participants
AdultADHDDailyData <- AdultADHDDailyData %>% 
  filter(!ID %in% badhormones) 

#Midfol as reference group
Phase_WM_MF <- lmerTest::lmer(BDEFS_WM_avg ~ periov_LH + earlylut_LH + midluteal_LH + perimenstrual_LH
                                     +(1|ID),
                                     data = AdultADHDDailyData) 
summary(Phase_WM_MF)
#PeriOv as reference group
Phase_WM_PO <- lmerTest::lmer(BDEFS_WM_avg ~ midfol_LH + earlylut_LH + midluteal_LH + perimenstrual_LH
                                     +(1|ID),
                                     data = AdultADHDDailyData) 
summary(Phase_WM_PO)
#EarlyLut as reference group
Phase_WM_EL <- lmerTest::lmer(BDEFS_WM_avg ~ midfol_LH + periov_LH + midluteal_LH + perimenstrual_LH
                                     +(1|ID),
                                     data = AdultADHDDailyData) 
summary(Phase_WM_EL)
#Midluteal as reference group
Phase_WM_ML <- lmerTest::lmer(BDEFS_WM_avg ~ midfol_LH + periov_LH +earlylut_LH + perimenstrual_LH
                                     +(1|ID),
                                     data = AdultADHDDailyData) 
summary(Phase_WM_ML)
#Perimenstrual as reference group
Phase_WM_PM <- lmerTest::lmer(BDEFS_WM_avg ~ midfol_LH + periov_LH +earlylut_LH + midluteal_LH
                                     +(1|ID),
                                     data = AdultADHDDailyData) 
summary(Phase_WM_PM)

#Hormone effects
WM_hormones <- lmerTest::lmer(BDEFS_WM_avg ~ Estradiol.d + Progesterone.d + Estradiol.d*Progesterone.d
                                     +(1 |ID),
                                     data = AdultADHDDailyData) 
summary(WM_hormones)
```
```{r}
#Plot Daily Data by Phase
#set up labels
AdultADHDDailyData$cyclephase_names <- factor(AdultADHDDailyData$cyclephase_LH, levels = c(1,2,3,4,5), labels = c("PO", "EL", "ML", "PM", "MF"))

#person-mean-center
data_for_plot1a <- AdultADHDDailyData %>% group_by(ID, cyclephase_names) %>% 
  summarize(BDEFS_WM_avg.m=mean(BDEFS_WM_avg.m),
            BDEFS_WMphase.m = mean(BDEFS_WM_avg, na.rm = TRUE),
            BDEFS_WMphase.d = BDEFS_WMphase.m - BDEFS_WM_avg.m)%>%
filter(!is.na(cyclephase_names))

plot1a <- data_for_plot1a %>% 
  group_by(cyclephase_names) %>%
  summarize(grand.m.BDEFS_WM_avg.d = mean(BDEFS_WMphase.d, na.rm=T),
            se=sd(BDEFS_WMphase.d, na.rm=T)/sqrt(n())) %>%
  #can save the above code into a separate dataset if preferred (dont have to do it in one line w/ ggplot)
  ggplot(aes(x=cyclephase_names, y=grand.m.BDEFS_WM_avg.d))+
  geom_line(group=1)+
  ##everything from here down is just formatting
  scale_x_discrete(labels=c("PO" = "Periovulatory",
                            "EL" = "Earlyluteal",
                            "ML" = "Midluteal",
                            "PM" = "Perimenstrual",
                            "MF" = "Midfollicular" ))+
  geom_errorbar(aes(ymin=grand.m.BDEFS_WM_avg.d-se, 
                    ymax=grand.m.BDEFS_WM_avg.d+se), 
                size=0.5, width=0.5, position=position_dodge())+
  geom_hline(yintercept=0.0, color="red", linetype="dashed")+
  theme_bw()+
  xlab("Cycle Phase")+
  ylab("Person-Centered BDEFS Working Memory")
#run plot1a in console to see plot
plot1a
```





## EATING MODELS AND GRAPHS

##DEBQ Emotional Eating Models
```{r}
#2/2/23 effects of phase on daily symptoms 
# model 2: predicting a linear outcome from one predictor, random intercepts, no cycle vars
badhormones <- c(206, 214, 221, 228)

#save new dataframe without all excluded participants
AdultADHDDailyData <- AdultADHDDailyData %>% 
  filter(!ID %in% badhormones) 

#Midfol as reference group
Phase_DEBQ_avg_MF <- lmerTest::lmer(DEBQ_avg ~ periov_LH + earlylut_LH + midluteal_LH + perimenstrual_LH
                                     +(1|ID),
                                     data = AdultADHDDailyData) 
summary(Phase_DEBQ_avg_MF)
#PeriOv as reference group
Phase_DEBQ_avg_PO <- lmerTest::lmer(DEBQ_avg ~ midfol_LH + earlylut_LH + midluteal_LH + perimenstrual_LH
                                     +(1|ID),
                                     data = AdultADHDDailyData) 
summary(Phase_DEBQ_avg_PO)
#EarlyLut as reference group
Phase_DEBQ_avg_EL <- lmerTest::lmer(DEBQ_avg ~ midfol_LH + periov_LH + midluteal_LH + perimenstrual_LH
                                     +(1|ID),
                                     data = AdultADHDDailyData) 
summary(Phase_DEBQ_avg_EL)
#Midluteal as reference group
Phase_DEBQ_avg_ML <- lmerTest::lmer(DEBQ_avg ~ midfol_LH + periov_LH +earlylut_LH + perimenstrual_LH
                                     +(1|ID),
                                     data = AdultADHDDailyData) 
summary(Phase_DEBQ_avg_ML)
#Perimenstrual as reference group
Phase_DEBQ_avg_PM <- lmerTest::lmer(DEBQ_avg ~ midfol_LH + periov_LH +earlylut_LH + midluteal_LH
                                     +(1|ID),
                                     data = AdultADHDDailyData) 
summary(Phase_DEBQ_avg_PM)

#Hormone effects
DEBQ_avg_hormones <- lmerTest::lmer(DEBQ_avg ~ Estradiol.d + Progesterone.d + Estradiol.d*Progesterone.d
                                     +(1 |ID),
                                     data = AdultADHDDailyData) 
summary(DEBQ_avg_hormones)
```
```{r}
#Plot Daily Data by Phase
#set up labels
AdultADHDDailyData$cyclephase_names <- factor(AdultADHDDailyData$cyclephase_LH, levels = c(1,2,3,4,5), labels = c("PO", "EL", "ML", "PM", "MF"))

#person-mean-center
data_for_plot1a <- AdultADHDDailyData %>% group_by(ID, cyclephase_names) %>% 
  summarize(DEBQ_avg.m=mean(DEBQ_avg.m),
            DEBQphase.m = mean(DEBQ_avg, na.rm = TRUE),
            DEBQphase.d = DEBQphase.m - DEBQ_avg.m)%>%
filter(!is.na(cyclephase_names))

plot1a <- data_for_plot1a %>% 
  group_by(cyclephase_names) %>%
  summarize(grand.m.DEBQ_avg.d = mean(DEBQphase.d, na.rm=T),
            se=sd(DEBQphase.d, na.rm=T)/sqrt(n())) %>%
  #can save the above code into a separate dataset if preferred (dont have to do it in one line w/ ggplot)
  ggplot(aes(x=cyclephase_names, y=grand.m.DEBQ_avg.d))+
  geom_line(group=1)+
  ##everything from here down is just formatting
  scale_x_discrete(labels=c("PO" = "Periovulatory",
                            "EL" = "Earlyluteal",
                            "ML" = "Midluteal",
                            "PM" = "Perimenstrual",
                            "MF" = "Midfollicular" ))+
  geom_errorbar(aes(ymin=grand.m.DEBQ_avg.d-se, 
                    ymax=grand.m.DEBQ_avg.d+se), 
                size=0.5, width=0.5, position=position_dodge())+
  geom_hline(yintercept=0.0, color="red", linetype="dashed")+
  theme_bw()+
  xlab("Cycle Phase")+
  ylab("Person-Centered Emotional Eating")
#run plot1a in console to see plot
plot1a
```





